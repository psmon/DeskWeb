# hwp한글 문서 파일 형식 5.0
```
1. 개요 한글의 문서 파일은 사용자가 따로 지정하지 않는 한 .HWP를 기본 확장자로 가진다. 문서 파일에 저장되는 내용은, 실제 사용자가 입력한 문서의 내용과 문자 장식 정보뿐만 아니라 문서를 편집할 당시의 글꼴에 대한 정보, 조판에 영향을 주는 설정 사항(용지 종류, 여백 정보 등)도 포함된다. 한글 문서 파일 형식 5.0은 2000년 10월 이후에 출시된 ?글 제품군(한글 워디안, 한글 2002, 한글 2005, 한글 2007, ?글 2010, ?글 2014, ?글 2018 등)에서 생성되며, 문서 버전에 따라 큰 골격은 유지되나, 추가적인 정보들에 의해 약간의 차이가 있다. 한글 문서 파일 형식 5.0은 파일의 크기를 최소화하기 위하여 압축 기능을 이용한다. 압축된 문서 파일도 기본적인 정보를 저장하는 부분은 압축되지 않으며, 실제 압축되는 부분은 사용자가 입력한 본문과 그림 관련 데이터 부분이다. 한글은 문서 파일의 압축에 zlib.org의 zlib을 사용했다. zlib은 웹상에 소스가 공개되어 있는 공개 소프트웨어이다. zlib은 zlib License를 따르며, 이는 소스의 자유로운 사용이 가능하며 해당 소스를 사용한 2차 산출물에 대한 소스 공개 의무가 없다. 자세한 사항은 zlib에 포함되어 있는 라이센스 문서 파일을 참조하기 바란다. 한글 문서 파일 형식5.0의 구조는 윈도우즈의 복합 파일(Compound File)에 기초를 두며, 문자 코드는 ISO-10646 표준을 기반으로 한다. 대부분의 문자 정보는 유니코드(UTF-16LE) 형식으로 전달되고, 저장된다. Compound File에 대한 접근 방법은 OLE관련
2. 자료형 설명 앞으로 계속되는 설명에서 한글의 문서 파일에 저장되는 정보는 아래 표에 설명하는 자료형을 이용해 표현한다. 자료형에서 한바이트는 8 비트로표현되며, 두 바이트이상의 길이를 가지는자료형은 최하위 바이트가 가장 먼저 저장되고, 최상위 바이트가 가장 나중에저장되는 리틀엔디언(Little-endian) 형태이다. 파일에 저장되는 자료가 배열(array)일 때는 ‘자료형 array[개수]’와 같이 표현한다. 예를 들어 10개의 원소를 갖는 word 배열이면 ‘word array[10]’과 같이 표현한다. WCHAR는 한글의 내부 코드로 표현된 문자 한 글자를 표현하는 자료형이다. 한글의 내부 코드는 한글, 영문, 한자를 비롯해 모든 문자가 2 바이트의 일정한 길이를 가진다. HWPUNIT과 SHWPUNIT는문자의 크기, 그림의 크기, 용지 여백 등, 문서를 구성하는 요소들의 크기를 표현하기 위한 자료형이다. 문서 출력 장치의 해상도는 가변적이기 때문에, 크기 정보를 점(도트)의 수로 표현할 수는 없다. 따라서 일정한 단위를 기준으로 해야 하는데, 한글에서는 1/7200인치를 기본 단위로사용한다. 예를 들어[가로2 인치x 세로 1인치]짜리그림의크기를 HWPUNIT 형으로 표현하면 각각 14400 x 7200이 된다.

자료형 길이 부호 설명 BYTE 1 부호 없는 한 바이트(0～255) WORD 2 16비트 컴파일러에서 ‘unsigned int’에 해당 DWORD 4 16비트 컴파일러에서 ‘unsigned long’에 해당 WCHAR 2 한글의 기본 코드로 유니코드 기반 문자 HWPUNIT 4 1/7200인치로 표현된 한글 내부 단위 SHWPUNIT 4 √ 1/7200인치로 표현된 한글 내부 단위 UINT8 1 ‘unsigned __int8’ 에 해당 UINT16 2 ‘unsigned __int16’ 에 해당 UINT32(=UINT) 4 ‘unsigned __int32’ 에 해당 INT8 1 √ ‘signed __int8’ 에 해당 INT16 2 √ ‘signed __int16’ 에 해당 INT32 4 √ ‘signed __int32’ 에 해당 HWPUNIT16 2 √ INT16 과 같다. COLORREF 4 RGB값(0x00bbggrr)을 십진수로 표시 (rr : red 1 byte, gg : green 1 byte, bb : blue 1 byte) BYTE stream 일련의 BYTE로 구성됨. 본문 내에서 다른 구조를 참조할 경우에 사용됨.
3. 한글 파일 구조 3.1. 한글 파일 구조 요약 한글의 문서 파일은 개괄적으로 다음 표와 같은 구조를 가진다. 복합 파일(Compound File) 구조를 가지기 때문에, 내부적으로 스토리지(Storage)와 스트림(Stream)을구별하기 위한이름을 가진다. 하나의스트림에는 일반적인 바이너리나 레코드 구조로 데이터가저장되고, 스트림에 따라서 압축/암호 화되기도 한다. Storage Stream
설명 구별 이름 길이(바이트) 레코드 구조 압축/암호화 파일 인식 정보 FileHeader 고정 문서 정보 DocInfo 고정 √ √ 본문 BodyText Section0 Section1 ... 가변 √ √ 문서 요약 \005HwpSummaryInformation 고정 바이너리 데이터 BinData BinaryData0 BinaryData1 ... 가변 √ 미리보기 텍스트 PrvText 고정 미리보기 이미지 PrvImage 가변 문서 옵션 DocOptions _LinkDoc DrmLicense ... 가변 스크립트 Scripts DefaultJScript JScriptVersion ... 가변 XML 템플릿 XMLTemplate Schema Instance ... 가변 문서 이력 관리 DocHistory VersionLog0 VersionLog1 ... 가변 √ √
압축된문서 파일의 경우 문서파일을 읽는 쪽에서는 ‘파일 인식정보’ 항목의 ‘압축’ 플래그를 살펴보고, 압축된파일이면 압축을 풀어서처리해야 한다. 이후의설명에서는 압축이풀린 상태의파일을 기준으로 한다. ‘문서정보’와 ‘본문’ ‘문서 이력 관리’에 사용되는 ‘레코드 구조’는 이후 ‘데이터 레코드’란에서 구조 설명과 사용되는 레코드들에 대한 상세한 설명을 한다. 3.2. 스토리지 별 저장 정보
3.2.1. 파일 인식 정보 한글의 문서 파일이라는 것을 나타내기 위해 ‘파일 인식 정보’가 저장된다. FileHeader 스트림에 저장되는 데이터는 다음과 같다.
TE array[32] 32 signature. 문서 파일은 "HWP Document File" DWORD 4 파일 버전. 0xMMnnPPrr의 형태(예 5.0.3.0) ? MM: 문서 형식의 구조가 완전히 바뀌는 것을 나타냄. 숫 자가 다르면 구 버전과 호환 불가능. ? nn: 큰 구조는 동일하나, 큰 변화가 있는 것을 나타냄. 숫 자가 다르면 구 버전과 호환 불가능. ? PP: 구조는 동일, Record가 추가되었거나, 하위 버전에서 호환되지 않는 정보가 추가된 것을 나타냄. 숫자가 달라도 구 버전과 호환 가능. ? rr: Record에 정보들이 추가된 것을 나타냄. 숫자가 달라 도 구 버전과 호환 가능. DWORD 4 속성 범위 설명 bit 0 압축 여부 bit 1 암호 설정 여부 bit 2 배포용 문서 여부 bit 3 스크립트 저장 여부 bit 4 DRM 보안 문서 여부 bit 5 XMLTemplate 스토리지 존재 여부 bit 6 문서 이력 관리 존재 여부 bit 7 전자 서명 정보 존재 여부 bit 8 공인 인증서 암호화 여부 bit 9 전자 서명 예비 저장 여부 bit 10 공인 인증서 DRM 보안 문서 여부 bit 11 CCL 문서 여부 bit 12 모바일 최적화 여부 bit 13 개인 정보 보안 문서 여부 bit 14 변경 추적 문서 여부 bit 15 공공누리(KOGL) 저작권 문서 bit 16 비디오 컨트롤 포함 여부 bit 17 차례 필드 컨트롤 포함 여부 bit 18～31 예약 DWORD 4 속성 범위 설명 bit 0 CCL, 공공누리 라이선스 정보 bit 1 복제 제한 여부 bit 2 동일 조건 하에 복제 허가 여부 (복제 제한인 경우 무시) bit 3～31 예약 DWORD 4 EncryptVersion ? 0 : None ? 1 : (한글 2.5 버전 이하) ? 2 : (한글 3.0 버전 Enhanced) ? 3 : (한글 3.0 버전 Old) ? 4 : (한글 7.0 버전 이후) BYTE 1 공공누리(KOGL) 라이선스 지원 국가 ? 6 : KOR ? 15 : US BYTE array[207] 207 예약 전체 길이 256 표 3 파일 인식 정보

3.2.2. 문서 정보 본문에 사용 중인 글꼴, 글자 속성, 문단 속성, 탭, 스타일 등에 문서 내 공통으로 사용되는 세부 정보를 담고 있다. DocInfo 스트림에 저장되는 데이터는 다음과 같다
Tag ID 길이(바이트) 레벨 설명 HWPTAG_DOCUMENT_PROPERTIES 30 0 문서 속성(표 14 참조) HWPTAG_ID_MAPPINGS 32 0 아이디 매핑 헤더(표 15 참조) HWPTAG_BIN_DATA 가변 1 바이너리 데이터(표 17 참조) HWPTAG_FACE_NAME 가변 1 글꼴(표 19 참조) HWPTAG_BORDER_FILL 가변 1 테두리/배경(표 23 참조) HWPTAG_CHAR_SHAPE 72 1 글자 모양(표 33 참조) HWPTAG_TAB_DEF 14 1 탭 정의(표 36 참조) HWPTAG_NUMBERING 가변 1 문단 번호(표 38 참조) HWPTAG_BULLET 10 1 글머리표(표 42 참조) HWPTAG_PARA_SHAPE 54 1 문단 모양(표 43 참조) HWPTAG_STYLE 가변 1 스타일(표 47 참조) HWPTAG_MEMO_SHAPE 22 1 메모 모양 HWPTAG_TRACK_CHANGE_AUTHOR 가변 1 변경 추적 작성자 HWPTAG_TRACK_CHANGE 가변 1 변경 추적 내용 및 모양 HWPTAG_DOC_DATA 가변 0 문서 임의의 데이터(표 49 참조) HWPTAG_FORBIDDEN_CHAR 가변 0 금칙처리 문자 HWPTAG_COMPATIBLE_DOCUMENT 4 0 호환 문서(표 54 참조) HWPTAG_LAYOUT_COMPATIBILITY 20 1 레이아웃 호환성(표 56 참조) HWPTAG_DISTRIBUTE_DOC_DATA 256 0 배포용 문서 HWPTAG_TRACKCHANGE 1032 1 변경 추적 정보 전체 길이 가변 Tag ID 길이(바이트) 레벨 설명 HWPTAG_PARA_HEADER 22 0 문단 헤더(표 58 참조) HWPTAG_PARA_TEXT 가변 1 문단의 텍스트(표 60 참조) 표 4 문서 정보
각각의 세부 정보는 란에서 추가로 다룬다. 3.2.3. 본문 문서의 본문에 해당되는 문단, 표, 그리기 개체 등의 내용이 저장된다. BodyText 스토리지는 본문의 구역에 따라 Section%d 스트림(%d는 구역의 번호)으로 구분된다. 구역 의 개수는 문서 정보의 문서 속성에 저장된다. 각 구역의 첫 문단에는 구역 정의 레코드가 저장되고, 각 단 설정의 첫 문단에는 단 정의 레코드가 저장된다. 각 구역의 가장 끝 위치에는 확장 바탕쪽(마지막 쪽, 임의 쪽) 관련 정보가 저장되고, 마지막 구역의 가장 끝 위치에는 메모 관련 정보가 저장된다. Section스트림에 저장되는 데이터는문단들(문단 리스트)이며, 다음과 같은문단 정보들이반복 된다.

Tag ID 길이(바이트) 레벨 설명 HWPTAG_PARA_HEADER 22 0 문단 헤더(표 58 참조) HWPTAG_PARA_TEXT 가변 1 문단의 텍스트(표 60 참조) 표 4 문서 정보 표 5 본문 ?글 문서 파일 형식 5.0 문단에컨트롤이 포함되는 경우컨트롤 헤더 이후로문단 리스트헤더와 같은 컨트롤의레코드 데이터가 저장된다. ? 제어 문자 (컨트롤) 표, 그림 등 일반 문자로 표현할 수 없는 요소를 표현하기 위해서 문자 코드 중 일부분을 특수 용도로 사용하고 있다. 문단 내용 중에 문자 코드가 0-31인 문자들은 특수 용도로 사용된다. 이미 13번 문자는 문단 내용의 끝 식별 기호로 사용된다는 것은 설명한 바 있다. 이외의 특수 문자들은 표나 그림 등, 일반 문자로 표현할 수 없는 문서 장식 요소를 표현하기 위해서 제어문자(컨트롤)로 사용된다. 제어 문자는 다음 세 가지 형식이 존재한다. - 문자 컨트롤 [char] = 하나의 문자로 취급되는 문자 컨트롤 / size = 1 - 인라인 컨트롤 [inline] = 별도의 오브젝트 포인터를 가리키지 않는 단순한인라인 컨트롤/ size = 8 - 확장 컨트롤 [extended] = 별도의 오브젝트가 데이터를 표현하는 확장 컨트롤 / size = 8 10 코드 설명 컨트롤 형식 0 unusable char 1 예약 extended 2 구역 정의/단 정의 extended 3 필드 시작(누름틀, 하이퍼링크, 블록 책갈피, 표 계산식, 문서 extended HWPTAG_PARA_CHAR_SHAPE 가변 1 문단의 글자 모양(표 61 참조) HWPTAG_PARA_LINE_SEG 가변 1 문단의 레이아웃 HWPTAG_PARA_RANGE_TAG 가변 1 문단의 영역 태그(표 63 참조) HWPTAG_CTRL_HEADER 4 1 컨트롤 헤더(표 64 참조) HWPTAG_LIST_HEADER 6 2 문단 리스트 헤더(표 65 참조) HWPTAG_PAGE_DEF 40 2 용지 설정 HWPTAG_FOOTNOTE_SHAPE 30 2 각주/미주 모양 HWPTAG_PAGE_BORDER_FILL 14 2 쪽 테두리/배경 HWPTAG_SHAPE_COMPONENT 4 2 개체 HWPTAG_TABLE 가변 2 표 개체 HWPTAG_SHAPE_COMPONENT_LINE 20 3 직선 개체 HWPTAG_SHAPE_COMPONENT_RECTANGLE 9 3 사각형 개체 HWPTAG_SHAPE_COMPONENT_ELLIPSE 60 3 타원 개체 HWPTAG_SHAPE_COMPONENT_ARC 25 3 호 개체 HWPTAG_SHAPE_COMPONENT_POLYGON 가변 3 다각형 개체 HWPTAG_SHAPE_COMPONENT_CURVE 가변 3 곡선 개체 HWPTAG_SHAPE_COMPONENT_OLE 26 3 OLE 개체 HWPTAG_SHAPE_COMPONENT_PICTURE 가변 3 그림 개체 HWPTAG_CTRL_DATA 가변 2 컨트롤 임의의 데이터 HWPTAG_EQEDIT 가변 2 수식 개체 HWPTAG_SHAPE_COMPONENT_TEXTART 가변 3 글맵시 HWPTAG_FORM_OBJECT 가변 2 양식 개체 HWPTAG_MEMO_SHAPE 22 1 메모 모양 HWPTAG_MEMO_LIST 4 1 메모 리스트 헤더 HWPTAG_CHART_DATA 2 2 차트 데이터 HWPTAG_VIDEO_DATA 가변 3 비디오 데이터 HWPTAG_SHAPE_COMPONENT_UNKNOWN 36 3 Unknown 전체 길이 가변

문단에컨트롤이 포함되는 경우컨트롤 헤더 이후로문단 리스트헤더와 같은 컨트롤의레코드 데이터가 저장된다. ? 제어 문자 (컨트롤) 표, 그림 등 일반 문자로 표현할 수 없는 요소를 표현하기 위해서 문자 코드 중 일부분을 특수 용도로 사용하고 있다. 문단 내용 중에 문자 코드가 0-31인 문자들은 특수 용도로 사용된다. 이미 13번 문자는 문단 내용의 끝 식별 기호로 사용된다는 것은 설명한 바 있다. 이외의 특수 문자들은 표나 그림 등, 일반 문자로 표현할 수 없는 문서 장식 요소를 표현하기 위해서 제어문자(컨트롤)로 사용된다. 제어 문자는 다음 세 가지 형식이 존재한다. - 문자 컨트롤 [char] = 하나의 문자로 취급되는 문자 컨트롤 / size = 1 - 인라인 컨트롤 [inline] = 별도의 오브젝트 포인터를 가리키지 않는 단순한인라인 컨트롤/ size = 8 - 확장 컨트롤 [extended] = 별도의 오브젝트가 데이터를 표현하는 확장 컨트롤 / size = 8
코드 설명 컨트롤 형식 0 unusable char 1 예약 extended 2 구역 정의/단 정의 extended 3 필드 시작(누름틀, 하이퍼링크, 블록 책갈피, 표 계산식, 문서 extended HWPTAG_PARA_CHAR_SHAPE 가변 1 문단의 글자 모양(표 61 참조) HWPTAG_PARA_LINE_SEG 가변 1 문단의 레이아웃 HWPTAG_PARA_RANGE_TAG 가변 1 문단의 영역 태그(표 63 참조) HWPTAG_CTRL_HEADER 4 1 컨트롤 헤더(표 64 참조) HWPTAG_LIST_HEADER 6 2 문단 리스트 헤더(표 65 참조) HWPTAG_PAGE_DEF 40 2 용지 설정 HWPTAG_FOOTNOTE_SHAPE 30 2 각주/미주 모양 HWPTAG_PAGE_BORDER_FILL 14 2 쪽 테두리/배경 HWPTAG_SHAPE_COMPONENT 4 2 개체 HWPTAG_TABLE 가변 2 표 개체 HWPTAG_SHAPE_COMPONENT_LINE 20 3 직선 개체 HWPTAG_SHAPE_COMPONENT_RECTANGLE 9 3 사각형 개체 HWPTAG_SHAPE_COMPONENT_ELLIPSE 60 3 타원 개체 HWPTAG_SHAPE_COMPONENT_ARC 25 3 호 개체 HWPTAG_SHAPE_COMPONENT_POLYGON 가변 3 다각형 개체 HWPTAG_SHAPE_COMPONENT_CURVE 가변 3 곡선 개체 HWPTAG_SHAPE_COMPONENT_OLE 26 3 OLE 개체 HWPTAG_SHAPE_COMPONENT_PICTURE 가변 3 그림 개체 HWPTAG_CTRL_DATA 가변 2 컨트롤 임의의 데이터 HWPTAG_EQEDIT 가변 2 수식 개체 HWPTAG_SHAPE_COMPONENT_TEXTART 가변 3 글맵시 HWPTAG_FORM_OBJECT 가변 2 양식 개체 HWPTAG_MEMO_SHAPE 22 1 메모 모양 HWPTAG_MEMO_LIST 4 1 메모 리스트 헤더 HWPTAG_CHART_DATA 2 2 차트 데이터 HWPTAG_VIDEO_DATA 가변 3 비디오 데이터 HWPTAG_SHAPE_COMPONENT_UNKNOWN 36 3 Unknown 전체 길이 가변 표 6 제어 문자 ?글 문서 파일 형식 5.0 문서 파일에서 문단 내용을 읽다가 제어 문자를 발견하면, 문서를 읽는 쪽에서는 제어 문자 종류에 따라 읽어 들이거나 건너 뛰어 다음 데이터의 시작 위치까지 파일 포인터를 옮기기 위한 적절한 처리를 수행해야 한다. 제어 문자 가운데는 또 다른 문단 리스트를 포함하는 경우도 있기 때문에, 제어 문자를 일반 문자처럼 처리하면 문서 파일을 정상적으로 읽을 수 없다. 표, 각주 등과 같은 문단 리스트를 포함하는 컨트롤 문자들은 독자적인 문단 리스트를 가진다. 해당 리스트들은 아래와 같은 리스트 헤더 정보를 포함한다. 실제 문단들은 그 다음에 serialize된다. 문단 내에서 컨트롤은 세 가지 형식에 따라 다음과 같은 차이가 있다. ? 문자 컨트롤 부가정보 없이 문자 하나로 표현되는 제어 문자이다. (3번째 ch) ? 인라인 컨트롤 부가정보가 12바이트(6 WCHAR) 이내에서 표현될 수 있는 제어 문자이다. info에 부가정보를 다 넣지 못하는 경우는 확장 컨트롤로 대체된다.(3~9까지 8개의 ch) ? 확장 컨트롤 11 요약, 사용자 정보, 현재 날짜/시간, 문서 날짜/시간, 파일 경로, 상호 참조, 메일 머지, 메모, 교정부호, 개인정보) 4 필드 끝 inline 5-7 예약 inline 8 title mark inline 9 탭 inline 10 한 줄 끝(line break) char 11 그리기 개체/표 extended 12 예약 extended 13 문단 끝(para break) char 14 예약 extended 15 숨은 설명 extended 16 머리말/꼬리말 extended 17 각주/미주 extended 18 자동번호(각주, 표 등) extended 19-20 예약 inline 21 페이지 컨트롤(감추기, 새 번호로 시작 등) extended 22 책갈피/찾아보기 표식 extended 23 덧말/글자 겹침 extended 24 하이픈 char 25-29 예약 char 30 묶음 빈칸 char 31 고정폭 빈칸 char
문서 파일에서 문단 내용을 읽다가 제어 문자를 발견하면, 문서를 읽는 쪽에서는 제어 문자 종류에 따라 읽어 들이거나 건너 뛰어 다음 데이터의 시작 위치까지 파일 포인터를 옮기기 위한 적절한 처리를 수행해야 한다. 제어 문자 가운데는 또 다른 문단 리스트를 포함하는 경우도 있기 때문에, 제어 문자를 일반 문자처럼 처리하면 문서 파일을 정상적으로 읽을 수 없다. 표, 각주 등과 같은 문단 리스트를 포함하는 컨트롤 문자들은 독자적인 문단 리스트를 가진다. 해당 리스트들은 아래와 같은 리스트 헤더 정보를 포함한다. 실제 문단들은 그 다음에 serialize된다. 문단 내에서 컨트롤은 세 가지 형식에 따라 다음과 같은 차이가 있다. ? 문자 컨트롤 부가정보 없이 문자 하나로 표현되는 제어 문자이다. (3번째 ch)
인라인 컨트롤 부가정보가 12바이트(6 WCHAR) 이내에서 표현될 수 있는 제어 문자이다. info에 부가정보를 다 넣지 못하는 경우는 확장 컨트롤로 대체된다.(3~9까지 8개의 ch)
제어 문자는 포인터를 가지고 있고, 포인터가 가리키는 곳에 실제 오브젝트가 존재하는 제어 문자이 다.(3~9까지 8개의 ch)
3.2.3. 문서 요약 \005HwpSummaryInfomation 스트림에는 한글 메뉴의 “파일-문서 정보-문서 요약”에서 입력한 내 용이 저장된다. Summary Information에 대한 자세한 설명은 MSDN을 참고 The Summary Information Property Set The DocumentSummaryInformation and UserDefined Property Set
Name Property ID string Property ID VT type Title PIDSI_TITLE 0x00000002 VT_LPSTR Subject PIDSI_SUBJECT 0x00000003 VT_LPSTR Author PIDSI_AUTHOR 0x00000004 VT_LPSTR Keywords PIDSI_KEYWORDS 0x00000005 VT_LPSTR Comments PIDSI_COMMENTS 0x00000006 VT_LPSTR Last Saved By PIDSI_LASTAUTHOR 0x00000008 VT_LPSTR Revision Number PIDSI_REVNUMBER 0x00000009 VT_LPSTR Last Printed PIDSI_LASTPRINTED 0x0000000B VT_FILETIME (UTC) Create Time/Date( (*)) PIDSI_CREATE_DTM 0x0000000C VT_FILETIME (UTC) Last saved Time/Date( (*)) PIDSI_LASTSAVE_DTM 0x0000000D VT_FILETIME (UTC) Number of Pages PIDSI_PAGECOUNT 0x0000000E VT_I4 Date String(User define) HWPPIDSI_DATE_STR 0x00000014 VT_LPSTR Para Count(User define) HWPPIDSI_PARACOUN T 0x00000015 VT_I4
3.2.4. 바이너리 데이터 BinData 스토리지에는 그림이나 OLE 개체와 같이 문서에 첨부된 바이너리 데이터가 각각의 스트림으 로 저장된다.
3.2.5. 미리보기 텍스트 12 Name Property ID string Property ID VT type Title PIDSI_TITLE 0x00000002 VT_LPSTR Subject PIDSI_SUBJECT 0x00000003 VT_LPSTR Author PIDSI_AUTHOR 0x00000004 VT_LPSTR Keywords PIDSI_KEYWORDS 0x00000005 VT_LPSTR Comments PIDSI_COMMENTS 0x00000006 VT_LPSTR Last Saved By PIDSI_LASTAUTHOR 0x00000008 VT_LPSTR Revision Number PIDSI_REVNUMBER 0x00000009 VT_LPSTR Last Printed PIDSI_LASTPRINTED 0x0000000B VT_FILETIME (UTC) Create Time/Date( (*)) PIDSI_CREATE_DTM 0x0000000C VT_FILETIME (UTC) Last saved Time/Date( (*)) PIDSI_LASTSAVE_DTM 0x0000000D VT_FILETIME (UTC) Number of Pages PIDSI_PAGECOUNT 0x0000000E VT_I4 Date String(User define) HWPPIDSI_DATE_STR 0x00000014 VT_LPSTR Para Count(User define) HWPPIDSI_PARACOUN T 0x00000015 VT_I4 표 7 문서 요약 ?글 문서 파일 형식 5.0 PrvText 스트림에는 미리보기 텍스트가 유니코드 문자열로 저장된다

3.2.6. 미리보기 이미지 PrvImage 스트림에는 미리보기 이미지가 BMP 또는 GIF 형식으로 저장된다. 3.2.8. 문서 옵션 DocOptions 스토리지에는 연결 문서, 배포용 문서, 공인인증서 DRM, 전자 서명 관련 정보가 각각의 스트림으로 저장된다. _LinkDoc 스트림에는 연결된 문서의 경로가 저장된다. DrmLicense 스트림에는 DRM Packaging의 Verision 정의가 저장된다. DrmRootSect 스트림에는 암호화 알고리즘이 저장된다. CertDrmHeader 스트림에는 DRM Packaging의 Verision 정의가 저장된다. CertDrmInfo 스트림에는 공인인증서 DRM 정보가 저장된다. DigitalSignature 스트림에는 전자 서명 정보가 저장된다. PublicKeyInfo 스트림에는 공개 키 정보가 저장된다

3.2.9. 스크립트 Scripts 스토리지에는 Script 코드를 저장한다. JScriptVersion 스트림에는 Script Version이 저장된다.

DWORD 4 스크립트 버전 HIGH DWORD 4 스크립트 버전 LOW 전체 길이 8 표 8 스크립트 버

DefaultJScript 스트림에는 Script 헤더, 소스, Pre 소스, Post 소스가 저장된다.

자료형 길이(바이트) 설명 DWORD 4 스크립트 헤더 길이 (len1) WCHAR array[len1] 2×len1 스크립트 헤더 DWORD 4 스크립트 소스 길이 (len2) WCHAR array[len2] 2×len2 스크립트 소스 DWORD 4 스크립트 Pre 소스 길이 (len3) WCHAR array[len3] 2×len3 스크립트 Pre 소스 DWORD 4 스크립트 Post 소스 길이 (len4) WCHAR array[len4] 2×len4 스크립트 Post 소스 DWORD 4 스크립트 end flag (-1) 전체 길이 20 + (2×len1) + (2×len2) + (2×len3) + (2×len4)

4. 데이터 레코드 4.1. 데이터 레코드 구조 논리적으로 연관된 데이터들을 헤더 정보와 함께 저장하는 방식을 데이터 레코드라고 한다. 레코드구조를 가지는스트림은 연속된 여러개의 레코드로구성된다. 데이터 레코드는헤더와 데이터로 구성되며 각 헤더 정보를 활용하여 전체 논리적 구조를 생성하게 된다. 레코드의 헤더에는 데이터 확장에 대비한 정보를 가지고 있다. 따라서 이후에 ?글의 기능이 확장되어 레코드에 데이터가 추가되는 경우에도 하위 버전의 ?글이 상위 버전의 ?글 문서를 읽을 수 있도록 하위 호환성이 보장된다.

레코드 헤더의 크기는 32bits이고 TagID(10bits), Level(10bits), Size(12bits)로 구성된다. ? Tag ID : 레코드가 나타내는 데이터의 종류를 나타내는 태그이다. Tag ID에는 10 비트가 사용되므 로 0x000 - 0x3FF까지 가능하다. - 0x000 - 0x00F = 일반 레코드 태그가 아닌 특별한 용도로 사용한다. - 0x010 - 0x1FF = 한글에 의해 내부용으로 예약된 영역(HWPTAG_BEGIN = 0x010) - 0x200 - 0x3FF = 외부 어플리케이션이 사용할 수 있는 영역 ? Level : 대부분 하나의 오브젝트는 여러 개의 레코드로 구성되는 것이 일반적이기 때문에 하나의 레코드가 아닌 "논리적으로 연관된 연속된 레코드"라는 개념이 필요하다. 레벨은 이와 같이 연관된 레코드의 논리적인 묶음을 표현하기 위한 정보이다. 스트림을 구성하는 모든 레코드는 계층 구조로 표현할 수 있는데, 레벨은 바로 이 계층 구조에서의 depth를 나타낸다. ? Size : 데이터 영역의 길이를 바이트 단위로 나타낸다. 12개의 비트가 모두 1일 때는 데이터 영역의 길이가 4095 바이트 이상인 경우로, 이때는 레코드 헤더에 연이어 길이를 나타내는 DWORD가 추가된다. 즉, 4095 바이트 이상의 데이터일 때 레코드는 다음과 같이 표현된다.
4.2. ’문서 정보’의 데이터 레코드 문서 정보(‘DocInfo’)에서 사용되는 데이터 레코드는 다음과 같다.

HWPTAG_DOCUMENT_PROPERTIES HWPTAG_BEGIN 문서 속성 HWPTAG_ID_MAPPINGS HWPTAG_BEGIN+1 아이디 매핑 헤더 HWPTAG_BIN_DATA HWPTAG_BEGIN+2 BinData HWPTAG_FACE_NAME HWPTAG_BEGIN+3 Typeface Name HWPTAG_BORDER_FILL HWPTAG_BEGIN+4 테두리/배경 HWPTAG_CHAR_SHAPE HWPTAG_BEGIN+5 글자 모양 HWPTAG_TAB_DEF HWPTAG_BEGIN+6 탭 정의 HWPTAG_NUMBERING HWPTAG_BEGIN+7 번호 정의 HWPTAG_BULLET HWPTAG_BEGIN+8 불릿 정의 HWPTAG_PARA_SHAPE HWPTAG_BEGIN+9 문단 모양 HWPTAG_STYLE HWPTAG_BEGIN+10 스타일 HWPTAG_DOC_DATA HWPTAG_BEGIN+11 문서의 임의의 데이터 HWPTAG_DISTRIBUTE_DOC_DATA HWPTAG_BEGIN+12 배포용 문서 데이터 RESERVED HWPTAG_BEGIN+13 예약 HWPTAG_COMPATIBLE_DOCUMENT HWPTAG_BEGIN+14 호환 문서 HWPTAG_LAYOUT_COMPATIBILITY HWPTAG_BEGIN+15 레이아웃 호환성 HWPTAG_TRACKCHANGE HWPTAG_BEGIN+16 변경 추적 정보 HWPTAG_MEMO_SHAPE HWPTAG_BEGIN+76 메모 모양 HWPTAG_FORBIDDEN_CHAR HWPTAG_BEGIN+78 금칙처리 문자 HWPTAG_TRACK_CHANGE HWPTAG_BEGIN+80 변경 추적 내용 및 모양 HWPTAG_TRACK_CHANGE_AUTHOR HWPTAG_BEGIN+81 변경 추적 작성자
4.2.1. 문서 속성 Tag ID : HWPTAG_DOCUMENT_PROPERTIES

자료형 길이(바이트) 설명 UINT16 2 구역 개수 문서 내 각종 시작번호에 대한 정보 UINT16 2 페이지 시작 번호 UINT16 2 각주 시작 번호 UINT16 2 미주 시작 번호 UINT16 2 그림 시작 번호 UINT16 2 표 시작 번호 UINT16 2 수식 시작 번호 문서 내 캐럿의 위치 정보 UINT32 4 리스트 아이디 UINT32 4 문단 아이디 UINT32 4 문단 내에서의 글자 단위 위치 전체 길이 26 Tag ID Value 의미 HWPTAG_DOCUMENT_PROPERTIES HWPTAG_BEGIN 문서 속성 HWPTAG_ID_MAPPINGS HWPTAG_BEGIN+1 아이디 매핑 헤더 HWPTAG_BIN_DATA HWPTAG_BEGIN+2 BinData HWPTAG_FACE_NAME HWPTAG_BEGIN+3 Typeface Name HWPTAG_BORDER_FILL HWPTAG_BEGIN+4 테두리/배경 HWPTAG_CHAR_SHAPE HWPTAG_BEGIN+5 글자 모양 HWPTAG_TAB_DEF HWPTAG_BEGIN+6 탭 정의 HWPTAG_NUMBERING HWPTAG_BEGIN+7 번호 정의 HWPTAG_BULLET HWPTAG_BEGIN+8 불릿 정의 HWPTAG_PARA_SHAPE HWPTAG_BEGIN+9 문단 모양 HWPTAG_STYLE HWPTAG_BEGIN+10 스타일 HWPTAG_DOC_DATA HWPTAG_BEGIN+11 문서의 임의의 데이터 HWPTAG_DISTRIBUTE_DOC_DATA HWPTAG_BEGIN+12 배포용 문서 데이터 RESERVED HWPTAG_BEGIN+13 예약 HWPTAG_COMPATIBLE_DOCUMENT HWPTAG_BEGIN+14 호환 문서 HWPTAG_LAYOUT_COMPATIBILITY HWPTAG_BEGIN+15 레이아웃 호환성 HWPTAG_TRACKCHANGE HWPTAG_BEGIN+16 변경 추적 정보 HWPTAG_MEMO_SHAPE HWPTAG_BEGIN+76 메모 모양 HWPTAG_FORBIDDEN_CHAR HWPTAG_BEGIN+78 금칙처리 문자 HWPTAG_TRACK_CHANGE HWPTAG_BEGIN+80 변경 추적 내용 및 모양 HWPTAG_TRACK_CHANGE_AUTHOR HWPTAG_BEGIN+81 변경 추적 작성자 표 13 문서 정보의 데이터 레코드 표 14 문서 속성
0 바이너리 데이터 1 한글 글꼴 2 영어 글꼴 3 한자 글꼴 4 일어 글꼴 5 기타 글꼴 6 기호 글꼴 7 사용자 글꼴 8 테두리/배경 9 글자 모양 10 탭 정의 11 문단 번호 12 글머리표 13 문단 모양 14 스타일 15 메모 모양 (5.0.2.1 이상) 16 변경추적 (5.0.3.2 이상) 17 변경추적 사용자 (5.0.3.2 이상) 표 15 아이디 매핑 헤더 표 16 아이디 매핑 개수 인덱스
4.2.2. 바이너리 데이터 Tag ID : HWPTAG_BIN_DATA 자료형 길이(바이트) 설명 그림, OLE 등의 바이너리 데이터 아이템에 대한 정보 UINT16 2 속성(표 18 참조) WORD 2 Type이 "LINK"일 때, 연결 파일의 절대 경로 길이 (len1) WCHAR array[len1] 2×len1 Type이 "LINK"일 때, 연결 파일의 절대 경로 WORD 2 Type이 "LINK"일 때, 연결 파일의 상대 경로 길이 (len2) WCHAR array[len2] 2×len2 Type이 "LINK"일 때, 연결 파일의 상대 경로 UINT16 2 Type이 "EMBEDDING"이거나 "STORAGE"일 때, BINDATASTORAGE에 저장된 바이너리 데이터의 아이디 WORD 2 Type이 "EMBEDDING"일 때, 바이너리 데이터의 형식 이름의 길이 (len3) WCHAR array[len3] 2×len3 Type이 "EMBEDDING"일 때 extension("." 제외) 그림의 경우 jpg bmp gif OLE의 경우 ole 전체 길이 가변 10 + (2×len1) + (2×len2) + (2×len3) 바이트

범위 구분 값 설명 bit 0～3 Type 0x0000 LINK. 그림 외부 파일 참조 0x0001 EMBEDDING. 그림 파일 포함 0x0002 STORAGE. OLE 포함 bit 4～5 압축 0x0000 스토리지의 디폴트 모드 따라감 0x0010 무조건 압축 0x0020 무조건 압축하지 않음 bit 8～9 상태 0x0000 아직 access 된 적이 없는 상태 0x0100 access에 성공하여 파일을 찾은 상태 0x0200 access가 실패한 에러 상태 0x0300 링크 access가 실패했으나 무시된 상태
글꼴 Tag ID : HWPTAG_FACE_NAME
자료형 길이(바이트) 설명 BYTE 1 속성(표 15 참조) WORD 2 글꼴 이름 길이(len1) WCHAR array[len1] 2×len1 글꼴 이름 BYTE 1 대체 글꼴 유형(표 16 참조) WORD 2 대체 글꼴 이름 길이(len2) WCHAR array[len2] 2×len2 대체 글꼴 이름 BYTE array[10] 10 글꼴 유형 정보(표 17 참조) WORD 2 기본 글꼴 이름 길이(len3) WCHAR array[len3] 2×len3 기본 글꼴 이름 전체 길이 가변 18 + (2×len1) + (2×len2) + (2×len3) 바이트
값 설명 0x80 대체 글꼴 존재 여부 0x40 글꼴 유형 정보 존재 여부 0x20 기본 글꼴 존재 여부 값 설명 0 원래 종류를 알 수 없을 때 1 트루타입 글꼴(TTF) 2 한글 전용 글꼴(HFT) 자료형 길이(바이트) 설명 BYTE 1 글꼴 계열 BYTE 1 세리프 유형 BYTE 1 굵기 BYTE 1 비례 BYTE 1 대조 BYTE 1 스트로크 편차 BYTE 1 자획 유형 BYTE 1 글자형 BYTE 1 중간선 BYTE 1 X-높이
4.2.5. 테두리/배경 Tag ID : HWPTAG_BORDER_FILL 21 자료형 길이(바이트) 설명 UINT16 2 속성(표 24 참조) UINT8 array[4] 4 4방향 테두리선 종류(표 25 참조) UINT8 array[4] 4 4방향 테두리선 굵기(표 26 참조) COLORREF array[4] 16 4방향 테두리선 색상. UINT8 1 대각선 종류(표 27 참조) UINT8 1 대각선 굵기 COLORREF 4 대각선 색깔 BYTE stream n 채우기 정보(표 28 참조) 전체 길이 가변 32+n 바이트
범위 설명 bit 0 3D 효과의 유무 bit 1 그림자 효과의 유무 bit 2～4 Slash 대각선 모양(시계 방향으로 각각의 대각선 유무를 나타냄) 000 : none 010 : slash 011 : LeftTop --> Bottom Edge 110 : LeftTop --> Right Edge 111 : LeftTop --> Bottom & Right Edge bit 5～7 BackSlash 대각선 모양(반시계 방향으로 각각의 대각선 유무를 나타냄) 000 : none 010 : / back slash 011 : RightTop --> Bottom Edge 110 : RightTop --> Left Edge 111 : RightTop --> Bottom & Left Edge bit 8～9 Slash 대각선 꺽은선 bit 10 BackSlash 대각선 꺽선 bit 11 Slash 대각선 모양 180도 회전 여부 bit 12 BackSlash 대각선 모양 180도 회전 여부 bit 13 중심선 유무. 표 23 테두리/배경 속성 표 24 테두리/배경 속성
값 설명 0 실선 1 긴 점선 2 점선 3 -.-.-.-. 4 -..-..-.. 5 Dash보다 긴 선분의 반복 6 Dot보다 큰 동그라미의 반복 7 2중선 8 가는선 + 굵은선 2중선 9 굵은선 + 가는선 2중선 10 가는선 + 굵은선 + 가는선 3중선 11 물결 12 물결 2중선

13 두꺼운 3D 14 두꺼운 3D(광원 반대) 15 3D 단선 16 3D 단선(광원 반대) 값 설명 값 설명 0 0.1 mm 8 0.6 mm 1 0.12 mm 9 0.7 mm 2 0.15 mm 10 1.0 mm 3 0.2 mm 11 1.5 mm 4 0.25 mm 12 2.0 mm 5 0.3 mm 13 3.0 mm 6 0.4 mm 14 4.0 mm 7 0.5 mm 15 5.0 mm 표 26 테두리선 굵기
값 설명 0 Slash 1 BackSlash 2 CrookedSlash 22 13 두꺼운 3D 14 두꺼운 3D(광원 반대) 15 3D 단선 16 3D 단선(광원 반대) 값 설명 값 설명 0 0.1 mm 8 0.6 mm 1 0.12 mm 9 0.7 mm 2 0.15 mm 10 1.0 mm 3 0.2 mm 11 1.5 mm 4 0.25 mm 12 2.0 mm 5 0.3 mm 13 3.0 mm 6 0.4 mm 14 4.0 mm 7 0.5 mm 15 5.0 mm 표 26 테두리선 굵기 표 27 대각선 종류

자료형 길이(바이트) 설명 UINT 4 채우기 종류(type) 0x00000000 : 채우기 없음 0x00000001 : 단색 채우기 0x00000002 : 이미지 채우기 0x00000004 : 그러데이션 채우기 단색 채우기 (type & 0x0000001 != 0) COLORREF 4 배경색 COLORREF 4 무늬색 INT32 4 무늬 종류(표 29 참조) 그러데이션 채우기 (type & 0x0000004 != 0) INT16 2 그러데이션 유형(표 30 참조) INT16 2 그러데이션의 기울임(시작 각) INT16 2 그러데이션의 가로 중심(중심 X 좌표) INT16 2 그러데이션의 세로 중심(중심 Y 좌표) INT16 2 그러데이션 번짐 정도(0 -100) INT16 2 그러데이션의 색 수(num). (워디안/한글2002/SE에서는 항상 2이다.) INT32 4×num 색상이 바뀌는 곳의 위치. (num > 2 일 경우에만) COLORREF array[num] 4×num 색상 이미지 채우기 (type & 0x0000002 != 0) BYTE 1 이미지 채우기 유형(표 31 참조) BYTE stream 5 그림 정보(표 32 참조) DWORD 4 type의 0x0004비트가 켜져 있으면 size(=추가적인 그라데이션 바이트) = 1, 아니면 size = 0 BYTE 1 그러데이션 번짐정도의 중심 (0..100) DWORD 4 추가 채우기 속성 길이(size) BYTE size 추가 채우기 속성 - 그러데이션일 경우(type & 0x0000001 != 0) 번짐 정도의 중심(0~100) : 1byte 전체 길이 가변 8 + n 바이트
값 설명 1 - - - - 2 ||||| 3 \\\\\ 4 ///// 5 +++++ 6 xxxxx 23 값 설명 1 줄무늬형 2 원형 3 원뿔형 4 사각형 표 28 채우기 정보 표 29 채우기 무늬 종류 표 30 그러데이션 유형
값 설명 0 바둑판식으로-모두 1 바둑판식으로-가로/위 2 바둑판식으로-가로/아래 3 바둑판식으로-세로/왼쪽 4 바둑판식으로-세로/오른쪽 5 크기에 맞추어 6 가운데로 7 가운데 위로 8 가운데 아래로 9 왼쪽 가운데로 10 왼쪽 위로 11 왼쪽 아래로 12 오른쪽 가운데로 13 오른쪽 위로 14 오른쪽 아래로 15 NONE 자료형 길이(바이트) 설명 INT8 1 밝기 INT8 1 명암 BYTE 1 그림 효과 값 설명 0 REAL_PIC 1 GRAY_SCALE 2 BLACK_WHITE 4 PATTERN8x8 UINT16 2 BinItem의 아이디 참조값 전체 길이 5 4.2.6. 글자 모양 Tag ID : HWPTAG_CHAR_SHAPE 24 자료형 길이(바이트) 설명 WORD array[7] 14 언어별 글꼴 ID(FaceID) 참조 값(표 34 참조) UINT8 array[7] 7 언어별 장평, 50%～200%(표 34 참조) INT8 array[7] 7 언어별 자간, -50%～50%(표 34 참조) UINT8 array[7] 7 언어별 상대 크기, 10%～250%(표 34 참조) INT8 array[7] 7 언어별 글자 위치, -100%～100%(표 34 참조) INT32 4 기준 크기, 0pt～4096pt UINT32 4 속성(표 30 참조) INT8 1 그림자 간격, -100%～100% INT8 1 그림자 간격, -100%～100% COLORREF 4 글자 색 COLORREF 4 밑줄 색 COLORREF 4 음영 색 COLORREF 4 그림자 색 UINT16 2 글자 테두리/배경 ID(CharShapeBorderFill ID) 참조 값 (5.0.2.1 이상) COLORREF 4 취소선 색 (5.0.3.0 이상) 전체 길이 72 표 31 이미지 채우기 유형 표 32 그림 정보
값 설명 0 한글 1 영어 2 한자 3 일어 4 기타 5 기호 6 사용자 표 34 글꼴에 대한 언어
범위 구분 값 설명 bit 0 기울임 여부 bit 1 진하게 여부 bit 2～3 밑줄 종류 0 없음 1 글자 아래 3 글자 위 bit 4～7 밑줄 모양 (표 25 참조) bit 8～10 외곽선 종류 0 없음 1 실선 2 점선 3 굵은 실선(두꺼운 선) 4 파선(긴 점선) 5 일점쇄선 (-.-.-.-.) 6 이점쇄선 (-..-..-..) bit 11～12 그림자 종류 0 없음 1 비연속 2 연속 bit 13 양각 여부 bit 14 음각 여부 bit 15 위 첨자 여부 bit 16 아래 첨자 여부 bit 17 Reserved. bit 18～20 취소선 여부 bit 21～24 강조점 종류 0 없음 1 검정 동그라미 강조점 2 속 빈 동그라미 강조점 3 ˇ 4 ? 5 ? 6 : bit 25 글꼴에 어울리는 빈칸 사용 여부 bit 26～29 취소선 모양 (표 25 참조) bit 30 Kerning 여부 값 설명 0 한글 1 영어 2 한자 3 일어 4 기타 5 기호 6 사용자 표 34 글꼴에 대한 언어 표 35 글자 모양 속성
4.2.7. 탭 정의 Tag ID : HWPTAG_TAB_DEF 자료형 길이(바이트) 설명 UINT32 4 속성 INT16 4 count 탭 정보 (count 개수) HPWUNIT 4 탭의 위치 UINT8 1 탭의 종류 값 설명 0 왼쪽 1 오른쪽 2 가운데 3 소수점 UINT8 1 채움 종류(표 25 참조) UINT16 2 8 바이트를 맞추기 위한 예약 전체 길이 8+(8×count) 4.2.8. 문단 번호 Tag ID : HWPTAG_NUMBERING 26 자료형 길이(바이트) 설명 BYTE stream 8 문단 머리 정보(표 39 참조) WORD 2 번호 형식 길이 (len) 7회 반복 수준(1～7) 각 레벨에 해당하는 숫자 또는 문자 또는 기호를 표시 WCHAR array[len] 2×len 번호 형식. 불릿 문단의 경우에는 사용되지 않는다. 문자열 내 특정 문자에 제어코드(^)를 붙임으로써 한글에서 표시되는 번호 문단 머리의 형식을 제어한다. ^n : 레벨 경로를 표시한다.(예: 1.1.1.1.1.1.1) ^N : 레벨 경로를 표시하며 마지막에 마침표를 하나 더 찍는다.(예: 1.1.1.1.1.1.1.) 표 36 참조) UINT16 2 시작 번호 UINT 4 수준별 시작번호 (5.0.2.5 이상) 7회 반복 수준(1～7) WORD 2 확장 번호 형식 길이 (len) 3회 반복 수준(8～10) 각 레벨에 해당하는 숫자 또는 문자 또는 기호를 표시 WCHAR array[len] 2×len 확장 번호 형식. 불릿 문단의 경우에는 사용되지 않는다. 문자열 내 특정 문자에 제어코드(^)를 붙임으로써 한글에서 표시되는 번호 문단 머리의 형식을 제어한다. ^n : 레벨 경로를 표시한다.(예: 범위 설명 bit 0 문단 왼쪽 끝 자동 탭(내어 쓰기용 자동 탭) 유무 bit 1 문단 오른쪽 끝 자동 탭 유무 표 36 탭 정의 표 37 탭 정의 속성
4.2.8. 문단 번호 Tag ID : HWPTAG_NUMBERING 26 자료형 길이(바이트) 설명 BYTE stream 8 문단 머리 정보(표 39 참조) WORD 2 번호 형식 길이 (len) 7회 반복 수준(1～7) 각 레벨에 해당하는 숫자 또는 문자 또는 기호를 표시 WCHAR array[len] 2×len 번호 형식. 불릿 문단의 경우에는 사용되지 않는다. 문자열 내 특정 문자에 제어코드(^)를 붙임으로써 한글에서 표시되는 번호 문단 머리의 형식을 제어한다. ^n : 레벨 경로를 표시한다.(예: 1.1.1.1.1.1.1) ^N : 레벨 경로를 표시하며 마지막에 마침표를 하나 더 찍는다.(예: 1.1.1.1.1.1.1.) 표 36 참조) UINT16 2 시작 번호 UINT 4 수준별 시작번호 (5.0.2.5 이상) 7회 반복 수준(1～7) WORD 2 확장 번호 형식 길이 (len) 3회 반복 수준(8～10) 각 레벨에 해당하는 숫자 또는 문자 또는 기호를 표시
자료형 길이(바이트) 설명 BYTE stream 8 문단 머리 정보(표 39 참조) WORD 2 번호 형식 길이 (len) 7회 반복 수준(1～7) 각 레벨에 해당하는 숫자 또는 문자 또는 기호를 표시 WCHAR array[len] 2×len 번호 형식. 불릿 문단의 경우에는 사용되지 않는다. 문자열 내 특정 문자에 제어코드(^)를 붙임으로써 한글에서 표시되는 번호 문단 머리의 형식을 제어한다. ^n : 레벨 경로를 표시한다.(예: 1.1.1.1.1.1.1) ^N : 레벨 경로를 표시하며 마지막에 마침표를 하나 더 찍는다.(예: 1.1.1.1.1.1.1.) 표 36 참조) UINT16 2 시작 번호 UINT 4 수준별 시작번호 (5.0.2.5 이상) 7회 반복 수준(1～7) WORD 2 확장 번호 형식 길이 (len) 3회 반복 수준(8～10) 각 레벨에 해당하는 숫자 또는 문자 또는 기호를 표시 WCHAR array[len] 2×len 확장 번호 형식. 불릿 문단의 경우에는 사용되지 않는다. 문자열 내 특정 문자에 제어코드(^)를 붙임으로써 한글에서 표시되는 번호 문단 머리의 형식을 제어한다. ^n : 레벨 경로를 표시한다.(예:
1.1.1.1.1.1.1) ^N : 레벨 경로를 표시하며 마지막에 마침표를 하나 더 찍는다.(예: 1.1.1.1.1.1.1.) 표 36 참조) UINT 4 확장 수준별 시작번호 (5.1.0.0 이상) 수준(8~10) 전체 길이 가변 10 + (2×len))×7 + 2 + (4×7) (2×len))×3 + (4×3) 바이트
1.1.1.1.2. 
자료형 길이(바이트) 설명 UINT 4 속성(표 40 참조) HWPUNIT16 2 너비 보정값 HWPUNIT16 2 본문과의 거리 UINT 4 글자 모양 아이디 참조

범위 구분 값 설명 bit 0～1 문단의 정렬 종류 0 왼쪽 1 가운데 2 오른쪽 bit 2 번호 너비를 실제 인스턴스 문자열의 너비에 따를지 여부 0 false 1 true bit 3 자동 내어 쓰기 여부 0 false 1 true bit 4 수준별 본문과의 거리 종류 0 글자 크기에 대한 상대 비율 1 값
값 설명 0 1, 2, 3 1 동그라미 쳐진 1, 2, 3 2 I, II, III 3 i, ii, iii 4 A, B, C 5 a, b, c 6 동그라미 쳐진 A, B, C 7 동그라미 쳐진 a, b, c 8 가, 나, 다 9 동그라미 쳐진 가, 나, 다 10 ㄱ, ㄴ, ㄷ 11 동그라미 쳐진 ㄱ, ㄴ, ㄷ 12 일, 이, 삼 13 一, 二, 三 14 동그라미 쳐진 一, 二, 三
4.2.9. 글머리표 Tag ID : HWPTAG_BULLET
자료형 길이(바이트) 설명 BYTE stream 8 문단 머리의 정보 WCHAR 2 글머리표 문자 INT32 4 이미지 글머리표 여부 (글머리표 :0, 이미지글머리표 : ID) BYTE stream 4 이미지 글머리 (대비, 밝기 ,효과, ID) WCHAR 2 체크 글머리표 문자 전체 길이 20 자료형 길이(바이트) 설명 UINT32 4 속성 1(표 44 참조) INT32 4 왼쪽 여백 INT32 4 오른쪽 여백 INT32 4 들여 쓰기/내어 쓰기 INT32 4 문단 간격 위 INT32 4 문단 간격 아래 INT32 4 줄 간격. ???글 2007 이하 버전(5.0.2.5 버전 미만)에서 사용. UINT16 2 탭 정의 아이디(TabDef ID) 참조 값 UINT16 2 번호 문단 ID(Numbering ID) 또는 글머리표 문단 모양 ID(Bullet ID) 참조 값 UINT16 2 테두리/배경 모양 ID(BorderFill ID) 참조 값 INT16 2 문단 테두리 왼쪽 간격 INT16 2 문단 테두리 오른쪽 간격 INT16 2 문단 테두리 위쪽 간격 INT16 2 문단 테두리 아래쪽 간격 UINT32 4 속성 2(표 40 참조) (5.0.1.7 버전 이상) UINT32 4 속성 3(표 41 참조) (5.0.2.5 버전 이상) UINT32 4 줄 간격(5.0.2.5 버전 이상) 전체 길이 54 범위 구분 값 설명 bit 0～1 줄 간격 종류. ???글 2007 이하 버전에서 사용. 0 글자에 따라(%) 1 고정값 2 여백만 지정 bit 2～4 정렬 방식 0 양쪽 정렬 1 왼쪽 정렬 2 오른쪽 정렬 3 가운데 정렬 4 배분 정렬 5 나눔 정렬 bit 5～6 줄 나눔 기준 영어 단위 0 단어 1 하이픈 2 글자 bit 7 줄 나눔 기준 한글 단위 0 어절 1 글자 bit 8 편집 용지의 줄 격자 사용 여부 표 42 글머리표
2.10. 문단 모양 Tag ID : HWPTAG_PARA_SHAPE 28 자료형 길이(바이트) 설명 BYTE stream 8 문단 머리의 정보 WCHAR 2 글머리표 문자 INT32 4 이미지 글머리표 여부 (글머리표 :0, 이미지글머리표 : ID) BYTE stream 4 이미지 글머리 (대비, 밝기 ,효과, ID) WCHAR 2 체크 글머리표 문자 전체 길이 20 자료형 길이(바이트) 설명 UINT32 4 속성 1(표 44 참조) INT32 4 왼쪽 여백 INT32 4 오른쪽 여백 INT32 4 들여 쓰기/내어 쓰기 INT32 4 문단 간격 위 INT32 4 문단 간격 아래 INT32 4 줄 간격. ???글 2007 이하 버전(5.0.2.5 버전 미만)에서 사용. UINT16 2 탭 정의 아이디(TabDef ID) 참조 값 UINT16 2 번호 문단 ID(Numbering ID) 또는 글머리표 문단 모양 ID(Bullet ID) 참조 값 UINT16 2 테두리/배경 모양 ID(BorderFill ID) 참조 값 INT16 2 문단 테두리 왼쪽 간격 INT16 2 문단 테두리 오른쪽 간격 INT16 2 문단 테두리 위쪽 간격 INT16 2 문단 테두리 아래쪽 간격 UINT32 4 속성 2(표 40 참조) (5.0.1.7 버전 이상) UINT32 4 속성 3(표 41 참조) (5.0.2.5 버전 이상) UINT32 4 줄 간격(5.0.2.5 버전 이상) 전체 길이 54
범위 구분 값 설명 bit 0～1 줄 간격 종류. ???글 2007 이하 버전에서 사용. 0 글자에 따라(%) 1 고정값 2 여백만 지정 bit 2～4 정렬 방식 0 양쪽 정렬 1 왼쪽 정렬 2 오른쪽 정렬 3 가운데 정렬 4 배분 정렬 5 나눔 정렬 bit 5～6 줄 나눔 기준 영어 단위 0 단어 1 하이픈 2 글자 bit 7 줄 나눔 기준 한글 단위 0 어절 1 글자 bit 8 편집 용지의 줄 격자 사용 여부
bit 9～15 공백 최소값 0%～75% bit 16 외톨이줄 보호 여부 bit 17 다음 문단과 함께 여부 bit 18 문단 보호 여부 bit 19 문단 앞에서 항상 쪽 나눔 여부 bit 20～21 세로 정렬 0 글꼴기준 1 위쪽 2 가운데 3 아래 bit 22 글꼴에 어울리는 줄 높이 여부 bit 23～24 문단 머리 모양 종류 0 없음 1 개요 2 번호 3 글머리표(bullet) bit 25～27 문단 수준 1수준～7수준 bit 28 문단 테두리 연결 여부 bit 29 문단 여백 무시 여부 bit 30 문단 꼬리 모양 범위 구분 값 설명 bit 0~1 한 줄로 입력 여부 bit 2~3 Reserved bit 4 한글과 영어 간격을 자동 조절 여부 bit 5 한글과 숫자 간격을 자동 조절 여부 범위 구분 값 설명 bit 0~4 줄 간격 종류 0 글자에 따라 1 고정 값 2 여백만 지정 3 최소
4.2.11. 스타일(문단 스타일) Tag ID : HWPTAG_STYLE 29 자료형 길이(바이트) 설명 WORD 2 길이 (len1) WCHAR array[len1] 2×len1 로컬 스타일 이름. 한글 윈도우에서는 한글 스타일 이름 WORD 2 길이 (len2) WCHAR array[len2] 2×len2 영문 스타일 이름 BYTE 1 속성(표 43 참조) BYTE 1 다음 스타일 아이디 참조값 INT16 2 언어 아이디(표 48 참조) UINT16 2 문단 모양 아이디 참조값(문단 모양의 아이디 속성) 스타일의 종류가 문단인 경우 반드시 지정해야 한다. UINT16 2 글자 모양 아이디(글자 모양의 아이디 속성) 스타일의 종류가 글자인 경우 반드시 지정해야 한다
전체 길이 가변 12 + (2×len1) + (2×len2) 바이트 자료형 길이(바이트) 설명 Parameter Set 가변 파라미터 셋(표 50 참조) 전체 길이 가변 범위 구분 값 설명 bit 0～2 스타일 종류 0 문단 스타일 1 글자 스타일 표 48 스타일 종류 표 49 문서 임의의 데이
파라미터 아이템의 개수만큼 아이템 데이터를 얻는다. 자료형 길이(바이트) 설명 WORD 2 파라미터 셋 ID INT16 2 파라미터 셋에 존재하는 아이템 개수(n) Parameter Item 가변×n 파라미터 아이템(표 51 참조) 전체 길이 가변 4 + (가변×n) 바이트
표 50 파라미터 셋
자료형 길이(바이트) 설명 WORD 2 파라미터 아이템 ID WORD 2 파라미터 아이템 종류(표 52 참조) Parameter Item Type 가변 파라미터 아이템 데이터 전체 길이 가변 4 + 가변 바이트 4.2.13. 배포용 문서 데이터 배포용 문서에서는 모든 스트림에 배포용 문서 데이터가 들어간다. Tag ID : HWPTAG_DISTRIBUTE_DOC_DATA 31 자료형 길이(바이트) 설명 BYTE array[256] 256 배포용 문서 데이터 전체 길이 값 구분 자료형 설명 0 PIT_NULL UINT NULL 1 PIT_BSTR WORD 문자열 길이(slen) WCHAR array[len] 문자열 2 PIT_I1 UINT INT8 3 PIT_I2 UINT INT16 4 PIT_I4 UINT INT32 5 PIT_I UINT INT 6 PIT_UI1 UINT UINT8 7 PIT_UI2 UINT UINT16 8 PIT_UI4 UINT UINT32 9 PIT_UI UINT UINT 0x8000 PIT_SET Parameter Set 파라미터 셋 0x8001 PIT_ARRAY INT16 파라미터 셋 개수 ParameterArray 파라미터 셋 배열 0x8002 PIT_BINDATA UINT16 바이너리 데이터 ID


4.3. ‘본문’의 데이터 레코드 본문에서 사용되는 데이터 레코드는 다음과 같다.
HEADER HWPTAG_BEGIN+50 문단 헤더 HWPTAG_PARA_TEXT HWPTAG_BEGIN+51 문단의 텍스트 HWPTAG_PARA_CHAR_SHAPE HWPTAG_BEGIN+52 문단의 글자 모양 HWPTAG_PARA_LINE_SEG HWPTAG_BEGIN+53 문단의 레이아웃 HWPTAG_PARA_RANGE_TAG HWPTAG_BEGIN+54 문단의 영역 태그 HWPTAG_CTRL_HEADER HWPTAG_BEGIN+55 컨트롤 헤더 HWPTAG_LIST_HEADER HWPTAG_BEGIN+56 문단 리스트 헤더 HWPTAG_PAGE_DEF HWPTAG_BEGIN+57 용지 설정 HWPTAG_FOOTNOTE_SHAPE HWPTAG_BEGIN+58 각주/미주 모양 HWPTAG_PAGE_BORDER_FILL HWPTAG_BEGIN+59 쪽 테두리/배경 HWPTAG_SHAPE_COMPONENT HWPTAG_BEGIN+60 개체 HWPTAG_TABLE HWPTAG_BEGIN+61 표 개체 HWPTAG_SHAPE_COMPONENT_LINE HWPTAG_BEGIN+62 직선 개체 HWPTAG_SHAPE_COMPONENT_RECTANGLE HWPTAG_BEGIN+63 사각형 개체 HWPTAG_SHAPE_COMPONENT_ELLIPSE HWPTAG_BEGIN+64 타원 개체 HWPTAG_SHAPE_COMPONENT_ARC HWPTAG_BEGIN+65 호 개체 HWPTAG_SHAPE_COMPONENT_POLYGON HWPTAG_BEGIN+66 다각형 개체 HWPTAG_SHAPE_COMPONENT_CURVE HWPTAG_BEGIN+67 곡선 개체 HWPTAG_SHAPE_COMPONENT_OLE HWPTAG_BEGIN+68 OLE 개체 HWPTAG_SHAPE_COMPONENT_PICTURE HWPTAG_BEGIN+69 그림 개체 HWPTAG_SHAPE_COMPONENT_CONTAINER HWPTAG_BEGIN+70 컨테이너 개체 HWPTAG_CTRL_DATA HWPTAG_BEGIN+71 컨트롤 임의의 데이터 HWPTAG_EQEDIT HWPTAG_BEGIN+72 수식 개체 RESERVED HWPTAG_BEGIN+73 예약 HWPTAG_SHAPE_COMPONENT_TEXTART HWPTAG_BEGIN+74 글맵시 HWPTAG_FORM_OBJECT HWPTAG_BEGIN+75 양식 개체 HWPTAG_MEMO_SHAPE HWPTAG_BEGIN+76 메모 모양 HWPTAG_MEMO_LIST HWPTAG_BEGIN+77 메모 리스트 헤더 HWPTAG_CHART_DATA HWPTAG_BEGIN+79 차트 데이터 HWPTAG_VIDEO_DATA HWPTAG_BEGIN+82 비디오 데이터 HWPTAG_SHAPE_COMPONENT_UNKNOWN HWPTAG_BEGIN+99 Unknow
4.3.1. 문단 헤더 Tag ID : HWPTAG_PARA_HEADER
자료형 길이(바이트) 설명 UINT32 4 text(=chars) if (nchars & 0x80000000) { nchars &= 0x7fffffff; } UINT32 4 control mask (UINT32)(1<
UINT16 2 range tag 정보 수 UINT16 2 각 줄에 대한 align에 대한 정보 수 UINT32 4 문단 Instance ID (unique ID) UINT16 2 변경추적 병합 문단여부. (5.0.3.2 버전 이상) 전체 길이 24 자료형 길이(바이트) 설명 WCHAR array[sizeof(nchars)] 2×nchars 문자수만큼의 텍스트 전체 길이 가변 (2×nchars) 바이트 자료형 길이(바이트) 설명 UINT32 4 글자 모양이 바뀌는 시작 위치 UINT32 4 글자 모양 ID 전체 길이 가변 8×n 값 설명 0x01 구역 나누기 0x02 다단 나누기 0x04 쪽 나누기 0x08 단 나누기

텍스트의 수가 1 이상이면 문자 수만큼 텍스트를 로드하고 그렇지 않을 경우 PARA_BREAK로 문단을 생성한다.
4.3.2. 문단의 텍스트 Tag ID : HWPTAG_PARA_TEXT
자료형 길이(바이트) 설명 WCHAR array[sizeof(nchars)] 2×nchars 문자수만큼의 텍스트 전체 길이 가변 (2×nchars) 바이트


4.3.3. 문단의 레이아웃 문단의 각 줄을 출력할 때 사용한 Cache 정보이며, 문단 정보의 ‘각 줄에 대한 align에 대한 정보 수’만큼 반복한다. Tag ID : HWPTAG_PARA_LINE_SEG
g ID : HWPTAG_PARA_LINE_SEG 4.3.5. 문단의 영역 태그 range tag 정보를 정보 수만큼 읽어 온다. range tag는 텍스트의 일정 영역을 마킹하는 용도로 사용되 며, 글자 모양과는 달리 각 영역은 서로 겹칠 수 있다.(형광펜, 교정 부호 등) Tag ID : HWPTAG_PARA_RANGE_TAG 4.3.6. 컨트롤 헤더 컨트롤 문자가 존재하면 컨트롤 문자로부터 존재하는 컨트롤 정보를 생성한다. 35 자료형 길이(바이트) 설명 UINT32 4 영역 시작 UINT32 4 영역 끝 UINT32 4 태그(종류 + 데이터) : 상위 8비트가 종류를 하위 24비트가 종류별로 다른 설명을 부여할 수 있는 임의의 데이터를 나타낸다. 전체 길이 가변 12×n 자료형 길이(바이트) 설명 UINT32 4 텍스트 시작 위치 INT32 4 줄의 세로 위치 INT32 4 줄의 높이 INT32 4 텍스트 부분의 높이 INT32 4 줄의 세로 위치에서 베이스라인까지 거리 INT32 4 줄간격 INT32 4 컬럼에서의 시작 위치 INT32 4 세그먼트의 폭 UINT32 4 태그 -bit 0 : 페이지의 첫 줄인지 여부 -bit 1 : 컬럼의 첫 줄인지 여부 -bit 16 : 텍스트가 배열되지 않은 빈 세그먼 트인지 여부 -bit 17 : 줄의 첫 세그먼트인지 여부 -bit 18 : 줄의 마지막 세그먼트인지 여부 -bit 19 : 줄의 마지막에 auto-hyphenation이 수행되었는지 여부. -bit 20 : indentation 적용 -bit 21 : 문단 머리 모양 적용 -bit 31 : 구현상의 편의를 위한 property
4.3.4. 문단의 영역 태그 range tag 정보를 정보 수만큼 읽어 온다. range tag는 텍스트의 일정 영역을 마킹하는 용도로 사용되 며, 글자 모양과는 달리 각 영역은 서로 겹칠 수 있다.(형광펜, 교정 부호 등) Tag ID : HWPTAG_PARA_RANGE_TAG 4.3.6. 컨트롤 헤더 컨트롤 문자가 존재하면 컨트롤 문자로부터 존재하는 컨트롤 정보를 생성한다. 35 자료형 길이(바이트) 설명 UINT32 4 영역 시작 UINT32 4 영역 끝 UINT32 4 태그(종류 + 데이터) : 상위 8비트가 종류를 하위 24비트가 종류별로 다른 설명을 부여할 수 있는 임의의 데이터를 나타낸다.
5. 
Tag ID : HWPTAG_CTRL_HEADER 4.3.7. 문단 리스트 헤더 Tag ID : HWPTAG_LIST_HEADER 4.3.8. 컨트롤 임의의 데이터 컨트롤의 필드 이름이나 하이퍼링크 정보를 저장한다. Tag ID : HWPTAG_CTRL_DATA 4.3.9. 개체 공통 속성을 포함하는 컨트롤(개체 컨트롤) extended type의 컨트롤은 종류를 나타내는 식별 기호로 32 비트 ID가 사용된다. 컨트롤 코드가 큰 범주를 나타내는 식별 기호라고 한다면, 컨트롤 ID는 세부 분류를 나타내는 식별기호인셈이다. 예를 들어 단 정의 컨트롤 ID는 MAKE_4CHID('c', 'o', 'l', 'd') 같은 형식으로 정의한다. MAKE_4CHID(a, b, c, d) (((a) << 24) | ((b) << 16) | ((c) << 8) | (d)) 36 자료형 길이(바이트) 설명 UINT32 4 컨트롤 ID 컨트롤 ID 이하 속성들은 CtrlID에 따라 다르다. - 각 컨트롤


4.3.7. 문단 리스트 헤더 Tag ID : HWPTAG_LIST_HEADER 4.3.8. 컨트롤 임의의 데이터 컨트롤의 필드 이름이나 하이퍼링크 정보를 저장한다. Tag ID : HWPTAG_CTRL_DATA 4.3.9. 개체 공통 속성을 포함하는 컨트롤(개체 컨트롤) extended type의 컨트롤은 종류를 나타내는 식별 기호로 32 비트 ID가 사용된다. 컨트롤 코드가 큰 범주를 나타내는 식별 기호라고 한다면, 컨트롤 ID는 세부 분류를 나타내는 식별기호인셈이다. 예를 들어 단 정의 컨트롤 ID는 MAKE_4CHID('c', 'o', 'l', 'd') 같은 형식으로 정의한다. MAKE_4CHID(a, b, c, d) (((a) << 24) | ((b) << 16) | ((c) << 8) | (d)) 36 자료형 길이(바이트) 설명 UINT32 4 컨트롤 ID 컨트롤 ID 이하 속성들은 CtrlID에 따라 다르다. - 각 컨트롤 및 개체 참고 전체 길이 4 자료형 길이(바이트) 설명 INT16 2 문단 수 UINT32 4 속성 범위 구분 값 설명 bit 0～2 텍스트 방향 0 가로 1 세로 bit 3～4 문단의 줄바꿈 0 일반적인 줄바꿈 1 자간을 조종하여 한 줄을 유지 2 내용에 따라 폭이 늘어남 bit 5～6 세로 정렬 0 top 1 center 2 bottom 전체 길이 6 자료형 길이(바이트) 설명 Parameter Set 가변 파라미터 셋(표 50 참조) 전체 길이 가변 표 64 컨트롤 헤더 표 65 문단 리스트 헤더


4.3.8. 컨트롤 임의의 데이터 컨트롤의 필드 이름이나 하이퍼링크 정보를 저장한다. Tag ID : HWPTAG_CTRL_DATA 4.3.9. 개체 공통 속성을 포함하는 컨트롤(개체 컨트롤) extended type의 컨트롤은 종류를 나타내는 식별 기호로 32 비트 ID가 사용된다. 컨트롤 코드가 큰 범주를 나타내는 식별 기호라고 한다면, 컨트롤 ID는 세부 분류를 나타내는 식별기호인셈이다. 예를 들어 단 정의 컨트롤 ID는 MAKE_4CHID('c', 'o', 'l', 'd') 같은 형식으로 정의한다. MAKE_4CHID(a, b, c, d) (((a) << 24) | ((b) << 16) | ((c) << 8) | (d))
1 표 MAKE_4CHID('t', 'b', 'l', ' ') √ 2 ( 그리기 개체 ) 선 사각형 타원 호 다각형 곡선 MAKE_4CHID('$', 'l', 'i', 'n') MAKE_4CHID('$', 'r', 'e', 'c') MAKE_4CHID('$', 'e', 'l', 'l') MAKE_4CHID('$', 'a', 'r', 'c') MAKE_4CHID('$', 'p', 'o', 'l') MAKE_4CHID('$', 'c', 'u', 'r') √ √ 3 ???글 97 수식 MAKE_4CHID('e', 'q', 'e', 'd') √ 4 그림 MAKE_4CHID('$', 'p', 'i', 'c') √ √ 5 OLE MAKE_4CHID('$', 'o', 'l', 'e') √ √ 6 묶음 개체 MAKE_4CHID('$', 'c', 'o', 'n') √ √
BYTE stream n 개체 공통 속성(표 69 참조) BYTE stream n2 캡션 정보가 있으면 캡션

자료형 길이(바이트) 설명 UINT32 4 ctrl ID UINT32 4 속성(표 70 참조) HWPUNIT 4 세로 오프셋 값 HWPUNIT 4 가로 오프셋 값 HWPUNIT 4 width 오브젝트의 폭 HWPUNIT 4 height 오브젝트의 높이 INT32 4 z-order HWPUNIT16 array[4] 2×4 오브젝트의 바깥 4방향 여백 UINT32 4 문서 내 각 개체에 대한 고유 아이디(instance ID) INT32 4 쪽나눔 방지 on(1) / off(0) WORD 2 개체 설명문 글자 길이(len) WCHAR array[len] 2×len 개체 설명문 글자 전체 길이 가변 46 + (2×len) 바이트
```