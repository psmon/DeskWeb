# HWP Viewer - Quick Start Guide

## 즉시 실행 방법

### 1. 로컬 웹 서버로 실행

```bash
cd /mnt/d/Code/Webnori/DeskWeb/refsrc/hwp-wasm-viewer

# Python 3가 설치되어 있다면
python3 -m http.server 8080

# 또는 Node.js의 http-server가 설치되어 있다면
npx http-server -p 8080
```

브라우저에서 `http://localhost:8080` 접속

### 2. 파일 열기

1. 브라우저에서 "HWP 파일 선택" 버튼 클릭
2. .hwp 파일 선택
3. 자동으로 파싱 및 렌더링

또는 드래그 앤 드롭으로 파일 열기

## 주요 기능

### ✅ 작동하는 기능

- **PrvText 텍스트 읽기**: HWP 파일의 미리보기 텍스트 추출 및 표시
- **FileHeader 정보**: 파일 버전, 압축 여부 등 메타데이터 표시
- **디버그 정보**: 파싱 과정 및 결과를 상세히 출력

### ⚠️ 제한사항

- **서식 정보 없음**: 글꼴, 크기, 색상 등이 적용되지 않음
- **복잡한 구조 미지원**: 표, 그림, 차트 등은 표시되지 않음
- **압축 레코드 파싱 실패**: 대부분의 경우 PrvText 대체 렌더링 사용

자세한 내용은 `IMPLEMENTATION_STATUS.md` 참조

## 테스트 파일

`sample/` 디렉토리에 테스트용 HWP 파일을 넣고 테스트하세요.

## 파일 구조

```
hwp-wasm-viewer/
├── index.html              # 메인 페이지
├── css/
│   └── style.css          # 스타일
├── js/
│   ├── cfb-reader.js      # CFB 파일 구조 파싱
│   ├── hwp-parser.js      # HWP 파서 (핵심)
│   ├── html-renderer.js   # HTML 렌더링
│   └── main.js            # 애플리케이션 로직
├── lib/
│   ├── cfb.min.js         # CFB 라이브러리
│   └── pako.min.js        # 압축 해제 라이브러리
└── sample/                # 테스트 파일 위치
```

## 브라우저 호환성

- ✅ Chrome/Edge (권장)
- ✅ Firefox
- ✅ Safari
- 최신 브라우저 사용 권장 (ES6+ 지원 필요)

## 문제 해결

### 파일이 열리지 않음
- 브라우저 콘솔(F12)에서 오류 확인
- 로컬 웹 서버를 통해 실행 (file:// 프로토콜은 제한적)

### 텍스트가 표시되지 않음
- PrvText 스트림이 없는 HWP 파일일 수 있음
- 디버그 정보에서 "PrvText 스트림을 찾을 수 없습니다" 메시지 확인

### 이상한 문자가 표시됨
- UTF-16LE 디코딩 문제일 수 있음
- 파일이 손상되었거나 다른 형식일 수 있음

## 다음 단계

본 프로젝트에 통합하기 전에:

1. **다양한 HWP 파일로 테스트**
   - 간단한 텍스트 문서
   - 복잡한 서식이 있는 문서
   - 표/그림이 포함된 문서

2. **PrvText 가용성 확인**
   - 모든 HWP 파일이 PrvText를 제공하는지 확인
   - PrvText가 없는 경우의 대체 방안 고려

3. **성능 테스트**
   - 큰 파일(10MB 이상) 테스트
   - 메모리 사용량 확인

4. **통합 방안 결정**
   - 클라이언트 사이드 vs 서버 사이드
   - 기능 범위 결정 (간단한 뷰어 vs 완전한 렌더링)

## 결론

현재 구현은 **기본적인 HWP 텍스트 읽기 POC**로 충분합니다.

**추천 사용 시나리오:**
- ✅ 간단한 문서 미리보기
- ✅ 텍스트 내용 확인
- ✅ 기술 검증

**비추천 시나리오:**
- ❌ 정확한 서식 재현
- ❌ 복잡한 문서 편집
- ❌ 프로덕션 수준의 뷰어

자세한 구현 상태는 `IMPLEMENTATION_STATUS.md` 참조
