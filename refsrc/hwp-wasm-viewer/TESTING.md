# HWP Viewer 테스트 가이드

## 🧪 로컬 테스트 방법

### 1. 간단한 HTTP 서버 실행

#### Python 사용
```bash
cd refsrc/hwp-wasm-viewer
python -m http.server 8000
```

#### Node.js 사용
```bash
cd refsrc/hwp-wasm-viewer
npx http-server -p 8000
```

#### PHP 사용
```bash
cd refsrc/hwp-wasm-viewer
php -S localhost:8000
```

### 2. 브라우저에서 접속
```
http://localhost:8000
```

### 3. HWP 파일 준비

테스트용 HWP 파일을 준비합니다:
- 간단한 텍스트 문서 (권장)
- 한글 2007 이상에서 생성된 HWP 5.0 파일
- 암호화되지 않은 파일

### 4. 파일 업로드

두 가지 방법으로 파일을 업로드할 수 있습니다:
1. **파일 선택 버튼 클릭** → 파일 선택
2. **드래그 앤 드롭** → HWP 파일을 브라우저로 드래그

## 📊 예상 결과

### 성공 케이스

1. **파일 정보 표시**
   - 파일명, 크기, 타입, 수정일

2. **디버그 정보 출력**
   ```
   === HWP 파일 파싱 결과 ===

   [ FileHeader ]
   서명: HWP Document File
   버전: 5.0.x.x
   압축: true/false
   암호화: false

   [ DocInfo ]
   레코드 수: XX개
   글꼴: X개
   ...

   [ Sections ]
   섹션 수: X
   Section 0:
     레코드: XX개
     문단: X개
     P0: XX자 - "문서 내용 미리보기..."
   ```

3. **렌더링 결과**
   - HTML로 변환된 문서 내용
   - 각 문단이 `<p>` 태그로 렌더링
   - 텍스트가 가독성 있게 표시

### 에러 케이스

#### 1. "CFB 파일 파싱 실패"
- **원인**: 올바른 HWP 파일이 아님
- **해결**: HWP 5.0 형식의 파일인지 확인

#### 2. "FileHeader 스트림이 유효하지 않습니다"
- **원인**: 손상된 파일 또는 지원하지 않는 형식
- **해결**: 다른 HWP 파일로 테스트

#### 3. "필수 라이브러리가 로드되지 않았습니다"
- **원인**: 인터넷 연결 문제로 CDN 로딩 실패
- **해결**: 인터넷 연결 확인 또는 오프라인 라이브러리 사용

#### 4. "압축 해제 실패"
- **원인**: zlib 압축 형식 문제
- **해결**: pako 라이브러리가 정상적으로 로드되었는지 확인

## 🔍 디버깅 팁

### 브라우저 개발자 도구 사용

1. **콘솔 열기**: `F12` 또는 `Ctrl+Shift+I`

2. **콘솔 로그 확인**:
   ```javascript
   // CFB 구조 확인
   CFB File Structure
   Storages: ...
   Streams: ...

   // 파싱 과정 확인
   HWP 파일 파싱 시작...
   FileHeader 파싱 완료
   DocInfo 파싱 완료
   Section0: X개 문단
   ```

3. **네트워크 탭 확인**:
   - cfb.min.js 로딩 확인
   - pako.min.js 로딩 확인

4. **에러 스택 추적**:
   - 콘솔의 빨간색 에러 메시지 확인
   - 스택 트레이스에서 문제 위치 파악

### 일반적인 문제 해결

| 문제 | 해결 방법 |
|-----|---------|
| 페이지가 로드되지 않음 | HTTP 서버가 실행 중인지 확인 |
| 파일 선택 후 아무 반응 없음 | 브라우저 콘솔에서 에러 확인 |
| 렌더링 결과가 비어있음 | HWP 파일에 텍스트가 있는지 확인 |
| 한글이 깨짐 | UTF-16LE 디코딩 문제, 파일 재확인 |

## 📝 테스트 체크리스트

### 기능 테스트

- [ ] 파일 선택 버튼으로 HWP 파일 업로드
- [ ] 드래그 앤 드롭으로 HWP 파일 업로드
- [ ] 파일 정보 정상 표시
- [ ] FileHeader 파싱 성공
- [ ] 압축된 파일 정상 처리
- [ ] 비압축 파일 정상 처리
- [ ] 문단 텍스트 정상 추출
- [ ] HTML 렌더링 정상 작동
- [ ] 디버그 정보 정상 출력

### 브라우저 호환성

- [ ] Chrome/Edge (Chromium)
- [ ] Firefox
- [ ] Safari
- [ ] 모바일 브라우저 (선택)

### 에러 처리

- [ ] 잘못된 파일 형식 에러 처리
- [ ] 손상된 파일 에러 처리
- [ ] 라이브러리 로딩 실패 에러 처리
- [ ] 사용자 친화적 에러 메시지

## 🎯 성능 테스트

### 파일 크기별 테스트

| 파일 크기 | 예상 처리 시간 | 권장 사항 |
|----------|--------------|---------|
| < 100KB | < 1초 | 최적 |
| 100KB - 1MB | 1-3초 | 양호 |
| 1MB - 5MB | 3-10초 | 주의 |
| > 5MB | > 10초 | 대용량 파일 경고 필요 |

### 메모리 사용

- 파일 크기의 약 2-3배 메모리 사용 예상
- 대용량 파일 처리 시 브라우저 메모리 모니터링 권장

## 📸 스크린샷 예시

### 성공적인 파싱 결과

1. **파일 선택 화면**
   - HWP 파일 선택 버튼
   - 드래그 앤 드롭 영역

2. **파싱 진행 중**
   - "파일을 읽는 중..." 메시지
   - "HWP 문서 파싱 중..." 메시지

3. **완료 화면**
   - 파일 정보 표시
   - 디버그 정보 (콘솔 형식)
   - 렌더링된 문서 내용

## 🐛 버그 리포트 가이드

버그를 발견하면 다음 정보를 포함하여 리포트해주세요:

1. **환경**
   - OS: (Windows/Mac/Linux)
   - 브라우저: (Chrome/Firefox/Safari) + 버전
   - 파일 크기: XX KB/MB

2. **재현 단계**
   1. 단계별 재현 방법
   2. 발생한 에러 메시지
   3. 브라우저 콘솔 로그

3. **예상 결과 vs 실제 결과**
   - 예상: 정상적으로 렌더링되어야 함
   - 실제: 에러 발생 또는 빈 화면

4. **추가 정보**
   - HWP 파일 정보 (버전, 생성 프로그램)
   - 스크린샷 (선택)

## 🔧 고급 디버깅

### CFB 구조 확인

브라우저 콘솔에서:
```javascript
// CFBReader 인스턴스에 접근
cfbReader.debugPrintStructure();

// 특정 스트림 확인
const fileHeader = cfbReader.readStream('FileHeader');
console.log(new Uint8Array(fileHeader));
```

### 레코드 파싱 확인

```javascript
// HWPParser 인스턴스에 접근
const records = parser.parseRecords(data);
records.forEach(r => {
    console.log(`TagID: 0x${r.tagId.toString(16)}, Level: ${r.level}, Size: ${r.size}`);
});
```

---

**Happy Testing!** 🎉
