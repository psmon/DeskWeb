# Record 구조 (Record Structure)

이 문서는 한글문서파일형식 5.0 명세서에서 추출되었습니다.

**총 페이지 수:** 8

---

## Page 3

```
글 문서 파일 형식 5.0
4.2.1. 문서 속성································································································································17
4.2.2. 아이디 매핑 헤더···················································································································17
4.2.3. 바이너리 데이터·····················································································································18
4.2.4. 글꼴········································································································································20
4.2.5. 테두리/배경·····························································································································21
4.2.6. 글자 모양································································································································24
4.2.7. 탭 정의···································································································································26
4.2.8. 문단 번호································································································································26
4.2.9. 글머리표·································································································································27
4.2.10. 문단 모양······························································································································28
4.2.11. 스타일(문단 스타일)··············································································································29
4.2.12. 문서 임의의 데이터··············································································································30
4.2.13. 배포용 문서 데이터··············································································································31
4.2.14. 호환 문서······························································································································32
4.2.15. 레이아웃 호환성···················································································································32
4.3. ‘본문’의 데이터 레코드·················································································································33
4.3.1. 문단 헤더 Tag ID : HWPTAG_PARA_HEADER···································································33
4.3.2. 문단의 텍스트·························································································································34
4.3.3. 문단의 글자 모양···················································································································34
4.3.4. 문단의 레이아웃·····················································································································35
4.3.5. 문단의 영역 태그···················································································································35
4.3.6. 컨트롤 헤더····························································································································35
4.3.7. 문단 리스트 헤더···················································································································36
4.3.8. 컨트롤 임의의 데이터············································································································36
4.3.9. 개체 공통 속성을 포함하는 컨트롤(개체 컨트롤)··································································36
4.3.9.1. 표 개체····························································································································39
4.3.9.2. 그리기 개체(선, 사각형, 타원, 호, 다각형, 곡선)···························································40
4.3.9.2.1. 개체 요소······················································································································40
4.3.9.2.2. 선 개체·························································································································42
4.3.9.2.3. 사각형 개체··················································································································43
4.3.9.2.4. 타원 개체······················································································································43
4.3.9.2.5. 다각형 개체··················································································································45
4.3.9.2.6. 호 개체·························································································································45
```

---

## Page 4

```
글 문서 파일 형식 5.0
4.3.9.2.7. 곡선 개체······················································································································45
4.3.9.3. 글 수식 개체················································································································46
4.3.9.4. 그림 개체(HWPTAG_SHAPE_COMPONENT_PICTURE)·················································46
4.3.9.5. OLE 개체(HWPTAG_SHAPE_COMPONENT_OLE)··························································49
4.3.9.6. 차트 개체·························································································································50
4.3.9.7. 묶음 개체(HWPTAG_SHAPE_COMPONENT_CONTAINER)············································51
4.3.9.8. 동영상 개체(HWPTAG_VIDEO_TDATA)··········································································51
4.3.10. 개체 이외의 컨트롤··············································································································52
4.3.10.1. 구역 정의·······················································································································53
4.3.10.1.1. 용지 설정····················································································································54
4.3.10.1.2. 각주/미주 모양············································································································55
4.3.10.1.3. 쪽 테두리/배경············································································································56
4.3.10.2. 단 정의··························································································································56
4.3.10.3. 머리말/꼬리말················································································································57
4.3.10.4. 각주/미주·······················································································································57
4.3.10.5. 자동 번호·······················································································································58
4.3.10.6. 새 번호 지정·················································································································58
4.3.10.7. 감추기····························································································································58
4.3.10.8. 홀/짝수 조정··················································································································59
4.3.10.9. 쪽 번호 위치·················································································································59
4.3.10.10. 찾아보기 표식··············································································································59
4.3.10.11. 책갈피··························································································································60
4.3.10.12. 글자 겹침·····················································································································60
4.3.10.13. 덧말······························································································································60
4.3.10.14. 숨은 설명·····················································································································60
4.3.10.15. 필드 시작·····················································································································61
4.4. 문서 이력 관리······························································································································62
4.4.1. 문서 이력 관리란···················································································································62
4.4.2. 문서 이력 관리 레코드 정보··································································································62
4.4.2.1. 히스토리 아이템 정보 시작·····························································································62
4.4.2.2. 히스토리 아이템 정보 끝································································································62
4.4.2.3. 히스토리 아이템 버전·····································································································63
4.4.2.4. 히스토리 날짜··················································································································63
```

---

## Page 21

```
글 문서 파일 형식 5.0
4. 데이터 레코드
4.1. 데이터 레코드 구조
논리적으로 연관된 데이터들을 헤더 정보와 함께 저장하는 방식을 데이터 레코드라고 한다.
레코드 구조를 가지는 스트림은 연속된 여러 개의 레코드로 구성된다. 데이터 레코드는 헤더와 데이터로
구성되며 각 헤더 정보를 활용하여 전체 논리적 구조를 생성하게 된다.
레코드의 헤더에는 데이터 확장에 대비한 정보를 가지고 있다. 따라서 이후에 글의 기능이 확장되어
레코드에 데이터가 추가되는 경우에도 하위 버전의 글이 상위 버전의 글 문서를 읽을 수 있도록
하위 호환성이 보장된다.
그림 45 레코드 구조
레코드 헤더의 크기는 32bits이고 TagID(10bits), Level(10bits), Size(12bits)로 구성된다.
§ Tag ID : 레코드가 나타내는 데이터의 종류를 나타내는 태그이다. Tag ID에는 10 비트가 사용되므
로 0x000 - 0x3FF까지 가능하다.
- 0x000 - 0x00F = 일반 레코드 태그가 아닌 특별한 용도로 사용한다.
- 0x010 - 0x1FF = 글에 의해 내부용으로 예약된 영역(HWPTAG_BEGIN = 0x010)
- 0x200 - 0x3FF = 외부 어플리케이션이 사용할 수 있는 영역
§ Level : 대부분 하나의 오브젝트는 여러 개의 레코드로 구성되는 것이 일반적이기 때문에 하나의
레코드가 아닌 "논리적으로 연관된 연속된 레코드"라는 개념이 필요하다. 레벨은 이와 같이 연관된
레코드의 논리적인 묶음을 표현하기 위한 정보이다. 스트림을 구성하는 모든 레코드는 계층 구조로
표현할 수 있는데, 레벨은 바로 이 계층 구조에서의 depth를 나타낸다.
§ Size : 데이터 영역의 길이를 바이트 단위로 나타낸다. 12개의 비트가 모두 1일 때는 데이터 영역의
길이가 4095 바이트 이상인 경우로, 이때는 레코드 헤더에 연이어 길이를 나타내는 DWORD가
추가된다. 즉, 4095 바이트 이상의 데이터일 때 레코드는 다음과 같이 표현된다.
레코드
헤더 (DWORD) 길이 (DWORD) 데이터
그림 46 확장 데이터 레코드 구조
16
```

---

## Page 40

```
글 문서 파일 형식 5.0
4.3.4. 문단의 레이아웃
문단의 각 줄을 출력할 때 사용한 Cache 정보이며, 문단 정보의 ‘각 줄에 대한 align에 대한 정보
수’만큼 반복한다.
Tag ID : HWPTAG_PARA_LINE_SEG
자료형 길이(바이트) 설명
UINT32 4 텍스트 시작 위치
INT32 4 줄의 세로 위치
INT32 4 줄의 높이
INT32 4 텍스트 부분의 높이
INT32 4 줄의 세로 위치에서 베이스라인까지 거리
INT32 4 줄간격
INT32 4 컬럼에서의 시작 위치
INT32 4 세그먼트의 폭
태그
-bit 0 : 페이지의 첫 줄인지 여부
-bit 1 : 컬럼의 첫 줄인지 여부
-bit 16 : 텍스트가 배열되지 않은 빈 세그먼
트인지 여부
-bit 17 : 줄의 첫 세그먼트인지 여부
UINT32 4
-bit 18 : 줄의 마지막 세그먼트인지 여부
-bit 19 : 줄의 마지막에 auto-hyphenation이
수행되었는지 여부.
-bit 20 : indentation 적용
-bit 21 : 문단 머리 모양 적용
-bit 31 : 구현상의 편의를 위한 property
전체 길이 36
표 62 문단의 레이아웃
4.3.5. 문단의 영역 태그
range tag 정보를 정보 수만큼 읽어 온다. range tag는 텍스트의 일정 영역을 마킹하는 용도로 사용되
며, 글자 모양과는 달리 각 영역은 서로 겹칠 수 있다.(형광펜, 교정 부호 등)
Tag ID : HWPTAG_PARA_RANGE_TAG
자료형 길이(바이트) 설명
UINT32 4 영역 시작
UINT32 4 영역 끝
태그(종류 + 데이터)
UINT32 4 : 상위 8비트가 종류를 하위 24비트가 종류별로 다른
설명을 부여할 수 있는 임의의 데이터를 나타낸다.
전체 길이 가변 12×n
표 63 문단의 영역 태그
4.3.6. 컨트롤 헤더
컨트롤 문자가 존재하면 컨트롤 문자로부터 존재하는 컨트롤 정보를 생성한다.
35
```

---

## Page 57

```
글 문서 파일 형식 5.0
WCHAR array[len] 2xlen 웹 태그
UINT16 2 썸내일 파일이 사용하는 스토리지의 BinData ID
전체 길이 (2xlen)+2
표 126 웹 동영상 속성
4.3.10. 개체 이외의 컨트롤
의미 컨트롤 ID 문단 리스트 파일 태그
1 구역 정의 MAKE_4CHID('s', 'e', 'c', 'd') √
2 단 정의 MAKE_4CHID('c', 'o', 'l', 'd')
MAKE_4CHID('h', 'e', 'a', 'd') /
3 머리말 / 꼬리말 √
MAKE_4CHID('f', 'o', 'o', 't')
MAKE_4CHID('f', 'n', ' ', ' ') /
4 각주 / 미주 √
MAKE_4CHID('e', 'n', ' ', ' ')
5 자동번호 MAKE_4CHID('a', 't', 'n', 'o')
6 새 번호 지정 MAKE_4CHID('n', 'w', 'n', 'o') HWPTAG_CTRL_HEAD로
부터 시작하며 ctrlid로
7 감추기 MAKE_4CHID('p', 'g', 'h', 'd')
각 개체를 확인 할 수
8 홀/짝수 조정 MAKE_4CHID('p', 'g', 'c', 't')
있다.
9 쪽 번호 위치 MAKE_4CHID('p', 'g', 'n', 'p')
10 찾아보기 표식 MAKE_4CHID('i', 'd', 'x', 'm')
11 책갈피 MAKE_4CHID('b', 'o', 'k', 'm')
12 글자 겹침 MAKE_4CHID('t', 'c', 'p', 's')
13 덧말 MAKE_4CHID('t', 'd', 'u', 't')
14 숨은 설명 MAKE_4CHID('t', 'c', 'm', 't') √
15 필드 시작 필드 컨트롤 ID
표 127 개체 이외의 컨트롤과 컨트롤 ID
특정 컨트롤은 정보 이외의 문단 리스트를 가질 수 있다.
컨트롤 ID
FIELD_UNKNOWN MAKE_4CHID('%', 'u', 'n', 'k')
FIELD_DATE MAKE_4CHID('%', 'd', 't', 'e')
FIELD_DOCDATE MAKE_4CHID('%', 'd', 'd', 't')
FIELD_PATH MAKE_4CHID('%', 'p', 'a', 't')
FIELD_BOOKMARK MAKE_4CHID('%', 'b', 'm', 'k')
FIELD_MAILMERGE MAKE_4CHID('%', 'm', 'm', 'g')
FIELD_CROSSREF MAKE_4CHID('%', 'x', 'r', 'f')
FIELD_FORMULA MAKE_4CHID('%', 'f', 'm', 'u')
FIELD_CLICKHERE MAKE_4CHID('%', 'c', 'l', 'k')
FIELD_SUMMARY MAKE_4CHID('%', 's', 'm', 'r')
FIELD_USERINFO MAKE_4CHID('%', 'u', 's', 'r')
FIELD_HYPERLINK MAKE_4CHID('%', 'h', 'l', 'k')
FIELD_REVISION_SIGN MAKE_4CHID('%', 's', 'i', 'g')
FIELD_REVISION_DELETE MAKE_4CHID('%', '%', '*', 'd')
FIELD_REVISION_ATTACH MAKE_4CHID('%', '%', '*', 'a')
FIELD_REVISION_CLIPPING MAKE_4CHID('%', '%', '*', 'C')
FIELD_REVISION_SAWTOOTH MAKE_4CHID('%', '%', '*', 'S')
FIELD_REVISION_THINKING MAKE_4CHID('%', '%', '*', 'T')
FIELD_REVISION_PRAISE MAKE_4CHID('%', '%', '*', 'P')
FIELD_REVISION_LINE MAKE_4CHID('%', '%', '*', 'L')
FIELD_REVISION_SIMPLECHANGE MAKE_4CHID('%', '%', '*', 'c')
FIELD_REVISION_HYPERLINK MAKE_4CHID('%', '%', '*', 'h')
52
```

---

## Page 65

```
글 문서 파일 형식 5.0
4.3.10.11. 책갈피
책갈피 컨트롤은 책갈피로서 갖는 정보로서 '책갈피이름'밖에 없으며, 컨트롤 임의의 데이터인
HWPTAG_CTRL_DATA로 레코드된다. (Tag: HWPTAG_CTRL_DATA 참조)
4.3.10.12. 글자 겹침
자료형 길이(바이트) 설명
UINT32 4 ctrl ID
WORD 2 겹칠 글자 길이(len)
WCHAR array[len] 2×len 겹칠 글자
UINT8 1 테두리 타입
INT8 1 내부 글자 크기
UINT8 1 테두리 내부 글자 펼침
UINT8 1 테두리 내부 글자 속성 아이디의 수 (cnt)
UINT array[cnt] 4 x cnt 테두리 내부 글자의 charshapeid 의 배열
전체 길이 가변 10 + (2×len) + (4×cnt)
표 150 글자 겹침
4.3.10.13. 덧말
자료형 길이(바이트) 설명
WORD 2 main Text 길이
WCHAR 2 main Text
WORD 2 sub Text 길이
WCHAR 2 sub Text
구분 값 설명
0 위
UINT 4
덧말의 위치 1 아래
2 가운데
UINT 4 Fsizeratio
UINT 4 Option
UINT 4 Style number
구분 값 설명
0 양쪽 정렬
1 왼쪽 정렬
UINT 4 2 오른쪽 정렬
정렬 기준
3 가운데 정렬
4 배분 정렬
5 나눔 정렬(공백에만 배분)
전체 길이 18
표 151 덧말
4.3.10.14. 숨은 설명
문단 리스트만을 포함한다.(문서 보안 레벨에 따라 숨은 설명 데이터들은 무효화될 수 있다.)
60
```

---

## Page 67

```
글 문서 파일 형식 5.0
4.4. 문서 이력 관리
문서 이력 관리에서 사용되는 데이터 레코드는 다음과 같다.
4.4.1. 문서 이력 관리란
글 '문서 이력 관리 정보’는 글 2005(6.5.0.724), 문서 형식 버전(Doc 5.0.1.7)부터 지원한다.
글 메뉴의 “파일-문서 이력 관리”에서 표시 및 생성되는 문서의 이력 정보를 저장하는 장소이다.(글
2005에서 글 2007까지는 ’버전 비교(파일-버전 비교)’라는 이름으로 ’문서 이력 관리 정보’ 기능을
제공하였다.)
문서 이력 정보의 각각의 아이템은 “히스토리” 혹은 “히스토리 아이템”이라 하며 글 Compound
구조 내에서 각 아이템은 “DocHistory”라는 스토리지 내부에 VersionLog%d(%d는 버전) 이름의 스트
림으로 저장된다. 또한, 각각 아이템은 압축, 암호화되어 저장된다.
이력 정보 데이터를 “DocHistory”라는 새로운 스토리지로 저장한다.
4.4.2. 문서 이력 관리 레코드 정보
4.4.2.1. 히스토리 아이템 정보 시작
Tag ID : HISTORY_RECORD_TYPE_STAG (0x10)
내 용 첨부 데이터 길이 및 Type
WORD flag
히스토리 아이템 정보 시작
UINT option
표 154 히스토리 아이템 정보 시작
✓ flag : 각 아이템에 대한 포함 레코드 flag
· HISTORY_INFO_FLAG_VERSION (0x01) : 버전 존재
· HISTORY_INFO_FLAG_DATE (0x02) : 날짜 존재
· HISTORY_INFO_FLAG_WRITER (0x04) : 작성자 존재
· HISTORY_INFO_FLAG_DESCRIPTION (0x08) : 설명 존재
· HISTORY_INFO_FLAG_DIFFDATA (0x10) : Diff Data 존재
· HISTORY_INFO_FLAG_LASTDOCDATA : 최근 문서 존재 (기록하지 않음, 필수)
· HISTORY_INFO_FLAG_LOCK (0x40) : 현재 히스토리 아이템 Lock 상태
✓ option : 버전 정보 관련 공통 옵션
· HWPVERSION_AUTOSAVE (0x00000001) : 문서 저장 시 자동 저장
4.4.2.2. 히스토리 아이템 정보 끝
Tag ID : HISTORY_RECORD_TYPE_ETAG (0x11)
내 용 첨부 데이터 Type
히스토리 아이템 정보 끝 NONE
표 155 히스토리 아이템 정보 끝
62
```

---

## Page 68

```
글 문서 파일 형식 5.0
4.4.2.3. 히스토리 아이템 버전
Tag ID : HISTORY_RECORD_TYPE_VERSION (0x20)
내 용 첨부 데이터 Type
히스토리 아이템 버전 DWORD
표 156 히스토리 아이템 버전
4.4.2.4. 히스토리 날짜
Tag ID : HISTORY_RECORD_TYPE_DATE (0x21)
내 용 첨부 데이터 Type
히스토리 날짜 SYSTEMDATE
표 157 히스토리 날짜
4.4.2.5. 히스토리 작성자
Tag ID : HISTORY_RECORD_TYPE_WRITER (0x22)
내 용 첨부 데이터 Type
히스토리 작성자 WCHAR
표 158 히스토리 작성자
4.4.2.6. 히스토리 설명
Tag ID : HISTORY_RECORD_TYPE_DESCRIPTION (0x23)
내 용 첨부 데이터 Type
히스토리 설명 WCHAR
표 159 히스토리 설명
4.4.2.7. 비교 정보
Tag ID : HISTORY_RECORD_TYPE_DIFFDATA (0x30)
내 용 첨부 데이터 Type
비교 정보 : DiffML WCHAR
표 160 비교 정보
4.4.2.8. 가장 마지막 최근 문서
Tag ID : HISTORY_RECORD_TYPE_LASTDOCDATA (0x31)
내 용 첨부 데이터 Type
가장 마지막 최근 문서
WCHAR
(HWPML)
표 161 가장 마지막 최근 문서
히스토리 아이템 저장 시 시작은 HISTORY_RECORD_TYPE_STAG 레코드로 시작하며, 아이템 내용
의 끝은 HISTORY_RECORD_TYPE_ETAG 레코드로 종료한다.
63
```

---

